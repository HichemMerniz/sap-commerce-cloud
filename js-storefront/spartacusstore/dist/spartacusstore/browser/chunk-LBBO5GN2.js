import{a as pt,b as Qi,c as vt,d as Gi,e as qi,f as Wi,g as ut,h as Yi,i as Ct,j as Hi,k as zi,l as Ki,n as Z,o as H,p as Zi,q as Ji}from"./chunk-6PLPM3PY.js";import{a as Ni,b as Ui}from"./chunk-7SPZNYRP.js";import{c as Oi}from"./chunk-7ASOYV3X.js";import{a as Ye,b as Ce,f as ji,i as Pi,p as lt}from"./chunk-ZR76AGJA.js";import"./chunk-64EE32CY.js";import{C as ye,H as We,M as Mi,N as Bi,O as $i,Q as ct,R as dt,S as Me,q as qe,r as st,s as ki}from"./chunk-LFKNHGJI.js";import{B as yi,C as Ei,Ca as wi,D as Di,F as xe,J as Ti,L as Ii,M as it,Nb as Vi,O as at,P as nt,Q as rt,b as vi,c as Ge,d as ui,da as ot,e as Ci,f as mi,ha as bi,i as ke,ja as Ai,k as Si,la as Li,na as Ri,o as gi,oa as Fi,r as hi,s as _i,w as fi,x as xi}from"./chunk-XOYCCVJR.js";import{$a as W,$d as si,Ab as Y,Ba as F,Bb as m,Ca as w,Cc as ti,Cd as Fe,Cf as ue,Df as Oe,G as Nt,Ga as Wt,I as O,Ib as zt,Ie as li,Jb as B,Je as pi,L as te,Lb as Kt,Ld as oi,Mc as ii,N as Ut,Nb as Zt,Ob as s,Oc as ai,P as $,Pa as o,Pb as c,Pc as j,Pd as de,Qa as f,Qb as Le,S as De,Tb as ne,Tc as ce,Uc as ni,V as Qt,Vc as J,Wc as ri,Ya as Te,_a as D,a as q,ab as v,b as X,ba as Ue,cb as Yt,cd as Je,cf as Xe,e as ee,ea as Gt,ed as Re,fa as E,fe as ci,gb as d,hb as l,hc as Jt,hf as et,ia as U,ib as A,ic as re,if as Qe,jb as T,jc as Xt,je as le,k as Pe,ka as he,kb as I,kc as ei,le as pe,m as Pt,mb as G,md as _e,na as Q,nc as oe,oa as k,ob as L,p as Ne,pb as _,pe as fe,qa as h,qe as di,r as K,ra as qt,re as ve,rf as tt,sb as Ht,se as we,tc as se,v as g,va as ie,vb as Ie,ve as Ve,w as ge,wa as M,wb as be,wd as y,xb as Ae,yb as ae,ye as b,zb as C,ze as P}from"./chunk-EVGLS3CH.js";var He=["element"],ha=()=>({cxRoute:"savedCarts"});function _a(a,t){if(a&1){let r=G();T(0),d(1,"div",2)(2,"a",3),s(3,"cxUrl"),d(4,"span"),C(5),s(6,"cxTranslate"),l()(),d(7,"a",4,0),s(9,"async"),L("click",function(){let i=F(r).ngIf,n=_();return w(n.saveCart(i))}),d(10,"span"),C(11),s(12,"cxTranslate"),l()()(),I()}if(a&2){let r=_();o(2),v("routerLink",c(3,5,zt(13,ha))),o(3),Y(c(6,7,"addToSavedCart.savedCarts")),o(2),Yt("disabled",c(9,9,r.disableSaveCartForLater$)),o(4),Y(c(12,11,"addToSavedCart.saveCartForLater"))}}function fa(a,t){if(a&1){let r=G();T(0),d(1,"div",2)(2,"div",3)(3,"button",4,0),L("click",function(){let i=F(r).ngIf,n=_();return w(n.openDialog(i,n.savedCartFormType.DELETE))}),C(5),s(6,"cxTranslate"),l()(),d(7,"div",3)(8,"button",5,0),L("click",function(){let i=F(r).ngIf,n=_();return w(n.openDialog(i,n.savedCartFormType.RESTORE))}),C(10),s(11,"cxTranslate"),l()()(),I()}a&2&&(o(5),m(" ",c(6,2,"savedCartDetails.deleteSavedCart")," "),o(5),m(" ",c(11,4,"savedCartList.makeCartActive")," "))}var xa=(a,t,r)=>({displayAddToCart:!0,addToCartString:a,optionalBtn:t,cartType:r}),ya=(a,t,r,e,i)=>({cartId:a,cartIsLoading:t,items:r,promotionLocation:e,options:i});function Ea(a,t){}function Da(a,t){if(a&1&&(T(0),A(1,"div",4),s(2,"cxTranslate"),d(3,"div",5),D(4,Ea,0,0,"ng-template",6),s(5,"async"),s(6,"async"),l(),I()),a&2){let r=_().ngIf,e=_(),i=ae(5);o(),W("aria-label",c(2,3,"common.loaded")),o(3),v("cxOutlet",e.CartOutlets.CART_ITEM_LIST)("cxOutletContext",Zt(13,ya,r.code,!c(5,5,e.cartLoaded$),r.entries,e.CartLocation.SavedCart,Kt(9,xa,c(6,7,e.buyItAgainTranslation$),i,e.CartType.SELECTIVE)))}}function Ta(a,t){if(a&1&&(T(0),D(1,Da,7,19,"ng-container",3),I()),a&2){let r=t.ngIf;_();let e=ae(3);o(),v("ngIf",(r==null||r.entries==null?null:r.entries.length)>0)("ngIfElse",e)}}function Ia(a,t){a&1&&(d(0,"div",7),A(1,"cx-spinner"),l())}function ba(a,t){if(a&1&&A(0,"cx-add-to-cart",8),a&2){let r=t.$implicit;v("productCode",r.item.product==null?null:r.item.product.code)("product",r.item.product)("showQuantity",!1)("options",r.options)("pickupStore",r.item.deliveryPointOfService==null?null:r.item.deliveryPointOfService.name)}}function Aa(a,t){if(a&1){let r=G();T(0),d(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),A(5,"cx-card",6),s(6,"async"),d(7,"button",7,0),s(9,"cxTranslate"),L("click",function(){let i=F(r).ngIf,n=_();return w(n.openDialog(i))}),A(10,"cx-icon",8),l()(),d(11,"div",9),A(12,"cx-card",10),s(13,"async"),l()(),d(14,"div",4),A(15,"cx-card",6),s(16,"async"),l(),d(17,"div",4),A(18,"cx-card",6),s(19,"cxDate"),s(20,"async"),A(21,"cx-card",6),s(22,"async"),l(),d(23,"div",4),A(24,"cx-card",6),s(25,"async"),A(26,"cx-card",6),s(27,"async"),l()()(),I()}if(a&2){let r=t.ngIf,e=_();o(5),v("content",c(6,11,e.getCartName(r==null?null:r.name))),o(2),W("aria-label",c(9,13,"savedCartDetails.editSavedCart")),o(3),v("type",e.iconTypes.PENCIL),o(2),v("content",c(13,15,e.getCartDescription(r==null?null:r.description)))("truncateText",!0)("charactersLimit",30),o(3),v("content",c(16,17,e.getCartId(r==null?null:r.code))),o(3),v("content",c(20,21,e.getDateSaved(c(19,19,r==null?null:r.saveTime)))),o(3),v("content",c(22,23,e.getCartItems(r==null?null:r.totalItems))),o(3),v("content",c(25,25,e.getCartQuantity(r==null?null:r.totalUnitCount))),o(2),v("content",c(27,27,e.getCartTotal(r==null||r.totalPriceWithTax==null?null:r.totalPriceWithTax.formattedValue)))}}var ea=a=>({count:a}),Be=a=>({savedCartId:a}),$e=a=>({cxRoute:"savedCartsDetails",params:a});function La(a,t){if(a&1){let r=G();d(0,"tr",13),L("click",function(){let i=F(r).$implicit,n=_(4);return w(n.goToSavedCartDetails(i))}),d(1,"td",14)(2,"div",15),C(3),s(4,"cxTranslate"),l(),d(5,"a",16),s(6,"cxUrl"),C(7),l()(),d(8,"td",17)(9,"div",15),C(10),s(11,"cxTranslate"),l(),d(12,"a",16),s(13,"cxUrl"),C(14),l()(),d(15,"td",18)(16,"div",15),C(17),s(18,"cxTranslate"),l(),d(19,"a",16),s(20,"cxUrl"),C(21),s(22,"cxDate"),l()(),d(23,"td",19)(24,"div",15),C(25),s(26,"cxTranslate"),l(),d(27,"a",16),s(28,"cxUrl"),C(29),l()(),d(30,"td",20)(31,"div",15),C(32),s(33,"cxTranslate"),l(),d(34,"a",16),s(35,"cxUrl"),C(36),l()(),d(37,"td",21),A(38,"div",15),d(39,"button",22,2),L("click",function(i){let n=F(r).$implicit,p=_(4);return w(p.openDialog(i,n))}),C(41),s(42,"cxTranslate"),l()()()}if(a&2){let r=t.$implicit;o(3),m(" ",c(4,16,"savedCartList.cartName")," "),o(2),v("routerLink",c(6,18,B(43,$e,B(41,Be,r==null?null:r.code)))),o(2),m(" ",r==null?null:r.name,""),o(3),m(" ",c(11,20,"savedCartList.cartId")," "),o(2),v("routerLink",c(13,22,B(47,$e,B(45,Be,r==null?null:r.code)))),o(2),Y(r==null?null:r.code),o(3),m(" ",c(18,24,"savedCartList.dateSaved")," "),o(2),v("routerLink",c(20,26,B(51,$e,B(49,Be,r==null?null:r.code)))),o(2),Y(Le(22,28,r==null?null:r.saveTime,"longDate")),o(4),m(" ",c(26,31,"savedCartList.quantity")," "),o(2),v("routerLink",c(28,33,B(55,$e,B(53,Be,r==null?null:r.code)))),o(2),m(" ",r==null?null:r.totalUnitCount,""),o(3),m(" ",c(33,35,"savedCartList.total")," "),o(2),v("routerLink",c(35,37,B(59,$e,B(57,Be,r==null?null:r.code)))),o(2),m(" ",r==null||r.totalPrice==null?null:r.totalPrice.formattedValue,""),o(5),m(" ",c(42,39,"savedCartList.makeCartActive")," ")}}function Ra(a,t){if(a&1&&(T(0),d(1,"table",7)(2,"thead",8)(3,"th",9),C(4),s(5,"cxTranslate"),l(),d(6,"th",9),C(7),s(8,"cxTranslate"),l(),d(9,"th",9),C(10),s(11,"cxTranslate"),l(),d(12,"th",10),C(13),s(14,"cxTranslate"),l(),d(15,"th",11),C(16),s(17,"cxTranslate"),l(),d(18,"th",9),C(19),s(20,"cxTranslate"),l()(),d(21,"tbody"),D(22,La,43,61,"tr",12),l()(),I()),a&2){let r=_(2).ngIf;o(4),m(" ",c(5,7,"savedCartList.cartName")," "),o(3),Y(c(8,9,"savedCartList.cartId")),o(3),Y(c(11,11,"savedCartList.dateSaved")),o(3),m(" ",c(14,13,"savedCartList.quantity")," "),o(3),m(" ",c(17,15,"savedCartList.total")," "),o(3),m(" ",c(20,17,"savedCartList.actions")," "),o(3),v("ngForOf",r)}}function Fa(a,t){a&1&&(d(0,"div",23)(1,"div",24)(2,"div"),C(3),s(4,"cxTranslate"),l()()()),a&2&&(o(3),Y(c(4,1,"savedCartList.notFound")))}function wa(a,t){if(a&1&&(T(0),A(1,"div",5),s(2,"cxTranslate"),d(3,"div",6)(4,"h2"),C(5),s(6,"cxTranslate"),l()(),D(7,Ra,23,19,"ng-container",4)(8,Fa,5,3,"ng-template",null,1,ne),I()),a&2){let r=ae(9),e=_().ngIf;o(),W("aria-label",c(2,4,"common.loaded")),o(4),m(" ",Le(6,6,"savedCartList.savedCarts",B(9,ea,e.length))," "),o(2),v("ngIf",(e==null?null:e.length)>0)("ngIfElse",r)}}function Va(a,t){a&1&&(d(0,"div",25),A(1,"cx-spinner"),l())}function Oa(a,t){if(a&1&&(T(0),D(1,wa,10,11,"ng-container",4),s(2,"async"),D(3,Va,2,0,"ng-template",null,0,ne),I()),a&2){let r=ae(4),e=_();o(),v("ngIf",!c(2,2,e.isLoading$))("ngIfElse",r)}}var ka=a=>({name:a});function Ma(a,t){a&1&&(T(0),C(1),s(2,"cxTranslate"),I()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.editSavedCart")," "))}function Ba(a,t){a&1&&(T(0),C(1),s(2,"cxTranslate"),I()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.deleteSavedCart")," "))}function $a(a,t){a&1&&(T(0),C(1),s(2,"cxTranslate"),I()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.saveForLater")," "))}function ja(a,t){a&1&&(T(0),C(1),s(2,"cxTranslate"),I()),a&2&&(o(),m(" ",c(2,1,"savedCartDialog.restoreSavedCart")," "))}function Pa(a,t){if(a&1&&(d(0,"div",25)(1,"label")(2,"span",26),C(3),s(4,"cxTranslate"),l(),A(5,"input",27),s(6,"cxTranslate"),l()()),a&2){let r,e=_(4);o(3),m(" ",c(4,3,"savedCartDialog.nameOfCloneCart")," "),o(2),Ht("placeholder",Le(6,5,"savedCartDialog.defaultCloneCartName",B(8,ka,(r=e.form.get("name"))==null?null:r.value))),v("maxLength",e.nameMaxLength)}}function Na(a,t){if(a&1){let r=G();T(0),d(1,"div",21)(2,"input",22),L("change",function(){F(r);let i=_(3);return w(i.toggleIsCloneSavedCart())}),l(),d(3,"label",23),C(4),s(5,"cxTranslate"),l()(),D(6,Pa,7,10,"div",24),I()}if(a&2){let r=_(3);o(2),v("checked",r.isCloneSavedCart),o(2),Y(c(5,3,"savedCartDialog.keepCopySavedCart")),o(2),v("ngIf",r.isCloneSavedCart)}}function Ua(a,t){if(a&1){let r=G();d(0,"button",29),s(1,"async"),s(2,"cxTranslate"),L("click",function(){F(r);let i=_(4);return w(i.deleteCart(i.cart.code))}),C(3),s(4,"cxTranslate"),l()}if(a&2){let r=_(4);v("disabled",c(1,3,r.isDisableDeleteButton$)),W("aria-label",c(2,5,"common.delete")),o(3),m(" ",c(4,7,"savedCartDialog.delete")," ")}}function Qa(a,t){if(a&1&&(T(0),D(1,Ua,5,9,"button",28),I()),a&2){let r=_(3);o(),v("ngIf",r.cart.code)}}function Ga(a,t){if(a&1){let r=G();d(0,"button",29),s(1,"async"),s(2,"cxTranslate"),L("click",function(){F(r);let i=_(4);return w(i.restoreSavedCart(i.cart.code))}),C(3),s(4,"cxTranslate"),l()}if(a&2){let r=_(4);v("disabled",c(1,3,r.isDisableRestoreButton$)),W("aria-label",c(2,5,"common.restore")),o(3),m(" ",c(4,7,"savedCartDialog.restore")," ")}}function qa(a,t){if(a&1&&D(0,Ga,5,9,"button",28),a&2){let r=_(3);v("ngIf",r.cart.code)}}function Wa(a,t){if(a&1){let r=G();T(0),d(1,"p",14),C(2),s(3,"cxTranslate"),l(),d(4,"div",15)(5,"div",16)(6,"div",17),C(7),s(8,"cxTranslate"),l(),d(9,"div",18),C(10),l()(),d(11,"div",16)(12,"div",17),C(13),s(14,"cxTranslate"),l(),d(15,"div",18),C(16),l()(),d(17,"div",16)(18,"div",17),C(19),s(20,"cxTranslate"),l(),d(21,"div",18),C(22),l()(),d(23,"div",16)(24,"div",17),C(25),s(26,"cxTranslate"),l(),d(27,"div",18),C(28),l()(),d(29,"div",16)(30,"div",17),C(31),s(32,"cxTranslate"),l(),d(33,"div",18),C(34),l()()(),D(35,Na,7,5,"ng-container",2),d(36,"div",19)(37,"button",20),s(38,"cxTranslate"),L("click",function(){F(r);let i=_(2);return w(i.close("Close Save Cart Dialog"))}),C(39),s(40,"cxTranslate"),l(),D(41,Qa,2,1,"ng-container",13)(42,qa,1,1,"ng-template",null,1,ne),l(),I()}if(a&2){let r=ae(43),e=_(2);o(2),m(" ",c(3,16,e.layoutOption===e.savedCartFormType.DELETE?"savedCartDialog.followingCartDelete":"savedCartDialog.followingCartRestore")," "),o(5),m(" ",c(8,18,"savedCartDialog.name")," "),o(3),m(" ",e.cart==null?null:e.cart.name," "),o(3),m(" ",c(14,20,"savedCartDialog.id")," "),o(3),m(" ",e.cart==null?null:e.cart.code," "),o(3),m(" ",c(20,22,"savedCartDialog.description")," "),o(3),m(" ",e.cart==null?null:e.cart.description," "),o(3),m(" ",c(26,24,"savedCartDialog.quantity")," "),o(3),m(" ",e.cart==null?null:e.cart.totalUnitCount," "),o(3),m(" ",c(32,26,"savedCartDialog.total")," "),o(3),m(" ",e.cart==null||e.cart.totalPriceWithTax==null?null:e.cart.totalPriceWithTax.formattedValue," "),o(),v("ngIf",e.layoutOption===e.savedCartFormType.RESTORE),o(2),W("aria-label",c(38,28,"common.close")),o(2),m(" ",c(40,30,"savedCartDialog.cancel")," "),o(2),v("ngIf",e.layoutOption===e.savedCartFormType.DELETE)("ngIfElse",r)}}function Ya(a,t){a&1&&(T(0),d(1,"p",14),C(2),s(3,"cxTranslate"),l(),I()),a&2&&(o(2),m(" ",c(3,1,"savedCartDialog.itemsSavedForLater")," "))}function Ha(a,t){if(a&1){let r=G();D(0,Ya,4,3,"ng-container",2),d(1,"div",15),T(2),d(3,"label")(4,"span",30),C(5),s(6,"cxTranslate"),l(),A(7,"input",31)(8,"cx-form-errors",32),l(),I(),l(),d(9,"div",15)(10,"label")(11,"span",30),C(12),s(13,"cxTranslate"),d(14,"span",33),C(15),s(16,"cxTranslate"),l()(),A(17,"textarea",34)(18,"cx-form-errors",32),d(19,"p",35),C(20),s(21,"cxTranslate"),l()()(),d(22,"div",19)(23,"button",36),s(24,"async"),s(25,"cxTranslate"),L("click",function(){F(r);let i=_(2);return w(i.close("Close Save Cart Dialog"))}),C(26),s(27,"cxTranslate"),l(),d(28,"button",37),s(29,"async"),s(30,"cxTranslate"),L("click",function(){F(r);let i=_(2);return w(i.saveOrEditCart(i.cart==null?null:i.cart.code))}),C(31),s(32,"cxTranslate"),l()()}if(a&2){let r=_(2);v("ngIf",r.layoutOption===r.savedCartFormType.SAVE),o(5),Y(c(6,15,"savedCartDialog.savedCartName")),o(2),v("maxLength",r.nameMaxLength),o(),v("control",r.form.get("name")),o(4),m("",c(13,17,"savedCartDialog.savedCartDescription")," "),o(3),m(" (",c(16,19,"savedCartDialog.optional"),") "),o(2),v("maxLength",r.descriptionMaxLength),o(),v("control",r.form.get("description")),o(2),m(" ",Le(21,21,"savedCartDialog.charactersLeft",B(36,ea,r.descriptionsCharacterLeft))," "),o(3),v("disabled",c(24,24,r.isLoading$)),W("aria-label",c(25,26,"common.close")),o(3),m(" ",c(27,28,"savedCartDialog.cancel")," "),o(2),v("disabled",c(29,30,r.isLoading$)),W("aria-label",c(30,32,"common.save")),o(3),m(" ",c(32,34,"savedCartDialog.save")," ")}}function za(a,t){if(a&1){let r=G();T(0),d(1,"div",3),L("esc",function(){F(r);let i=_();return w(i.close("Escape clicked"))}),d(2,"form",4)(3,"div",5),T(4,6),d(5,"div",7),D(6,Ma,3,3,"ng-container",8)(7,Ba,3,3,"ng-container",8)(8,$a,3,3,"ng-container",8)(9,ja,3,3,"ng-container",8),l(),I(),d(10,"button",9),s(11,"async"),s(12,"cxTranslate"),L("click",function(){F(r);let i=_();return w(i.close("Close Save Cart Dialog"))}),d(13,"span",10),A(14,"cx-icon",11),l()()(),d(15,"div",12),D(16,Wa,44,32,"ng-container",13)(17,Ha,33,38,"ng-template",null,0,ne),l()()(),I()}if(a&2){let r=ae(18),e=_();o(),v("cxFocus",e.focusConfig),o(),v("formGroup",e.form),o(2),v("ngSwitch",e.layoutOption),o(2),v("ngSwitchCase",e.savedCartFormType.EDIT),o(),v("ngSwitchCase",e.savedCartFormType.DELETE),o(),v("ngSwitchCase",e.savedCartFormType.SAVE),o(),v("ngSwitchCase",e.savedCartFormType.RESTORE),o(),v("disabled",c(11,12,e.isLoading$)),W("aria-label",c(12,14,"common.close")),o(4),v("type",e.iconTypes.CLOSE),o(2),v("ngIf",e.layoutOption===e.savedCartFormType.DELETE||e.layoutOption===e.savedCartFormType.RESTORE)("ngIfElse",r)}}var Ka=(()=>{let t=class t{constructor(e,i,n,p,R){this.activeCartFacade=e,this.authService=i,this.routingService=n,this.vcr=p,this.launchDialogService=R,this.subscription=new ee,this.loggedIn=!1}ngOnInit(){this.cart$=ge([this.activeCartFacade.getActive(),this.authService.isUserLoggedIn()]).pipe(U(([e,i])=>this.loggedIn=i),g(([e])=>e)),this.disableSaveCartForLater$=this.cart$.pipe(g(e=>!e.entries?.length))}saveCart(e){this.subscription.add(this.disableSaveCartForLater$.subscribe(i=>{i||(this.loggedIn?this.openDialog(e):this.routingService.go({cxRoute:"login"}))}))}openDialog(e){let i=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:"save"});i&&this.subscription.add(i.pipe($(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(We),f(si),f(de),f(Te),f(xe))},t.\u0275cmp=ie({type:t,selectors:[["cx-add-to-saved-cart"]],viewQuery:function(i,n){if(i&1&&Ie(He,5),i&2){let p;be(p=Ae())&&(n.element=p.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-add-to-saved-cart-container"],["cxAutoFocus","",1,"link","cx-action-link",3,"routerLink"],["tabindex","0","cxAutoFocus","",1,"link","cx-action-link",3,"click"]],template:function(i,n){i&1&&(D(0,_a,13,14,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.cart$))},dependencies:[re,Je,oe,ue,et],encapsulation:2,changeDetection:0});let a=t;return a})(),Za=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({providers:[_e({cmsComponents:{AddToSavedCartsComponent:{component:Ka}}})],imports:[se,Re,Oe,Qe]});let a=t;return a})(),St=(()=>{let t=class t{constructor(e,i){this.routingService=e,this.savedCartService=i,this.savedCartId$=this.routingService.getRouterState().pipe(g(n=>n.state.params.savedCartId),De()),this.savedCart$=this.savedCartId$.pipe(O(n=>!!n),U(n=>this.savedCartService.loadSavedCart(n)),E(n=>this.savedCartService.get(n)),Ue({bufferSize:1,refCount:!0}))}getSavedCartId(){return this.savedCartId$}getCartDetails(){return this.savedCart$}};t.\u0275fac=function(i){return new(i||t)(h(de),h(Z))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),Ja=(()=>{let t=class t{constructor(e,i,n){this.savedCartDetailsService=e,this.vcr=i,this.launchDialogService=n,this.subscription=new ee,this.savedCartFormType=H,this.savedCart$=this.savedCartDetailsService.getCartDetails()}openDialog(e,i){let n=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:i});n&&this.subscription.add(n.pipe($(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(St),f(Te),f(xe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-action"]],viewQuery:function(i,n){if(i&1&&Ie(He,5),i&2){let p;be(p=Ae())&&(n.element=p.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-saved-cart-restore-btns","row"],[1,"col-xs-12","col-md-5","col-lg-4"],[1,"btn","btn-block","btn-secondary",3,"click"],[1,"btn","btn-block","btn-primary",3,"click"]],template:function(i,n){i&1&&(D(0,fa,12,6,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,oe,ue],encapsulation:2});let a=t;return a})(),Xa=(()=>{let t=class t{constructor(e,i,n,p,R,u){this.savedCartDetailsService=e,this.savedCartService=i,this.eventSercvice=n,this.globalMessageService=p,this.routingService=R,this.translation=u,this.subscription=new ee,this.CartOutlets=Mi,this.CartType=$i,this.CartLocation=Bi,this.cartLoaded$=this.savedCartDetailsService.getSavedCartId().pipe(E(S=>this.savedCartService.isStable(S))),this.savedCart$=this.savedCartDetailsService.getCartDetails().pipe(U(S=>{(S?.entries??[]).length<=0&&S?.code&&this.savedCartService.deleteSavedCart(S.code)}))}ngOnInit(){this.subscription.add(this.eventSercvice.get(st).pipe($(1),g(()=>!0)).subscribe(e=>this.onDeleteComplete(e))),this.buyItAgainTranslation$=this.translation.translate("addToCart.addToActiveCart")}onDeleteComplete(e){e&&(this.routingService.go({cxRoute:"savedCarts"}),this.globalMessageService.add({key:"savedCartDialog.deleteCartSuccess"},ve.MSG_TYPE_CONFIRMATION))}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(St),f(Z),f(fe),f(we),f(de),f(Xe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-items"]],decls:6,vars:3,consts:[["emptyCartItems",""],["addToCartBtn",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["role","status"],[1,"cart-details-wrapper"],[3,"cxOutlet","cxOutletContext"],[1,"cx-spinner"],[3,"productCode","product","showQuantity","options","pickupStore"]],template:function(i,n){i&1&&(D(0,Ta,2,2,"ng-container",2),s(1,"async"),D(2,Ia,2,0,"ng-template",null,0,ne)(4,ba,1,5,"ng-template",null,1,ne)),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,rt,Ti,Ni,oe,ue],encapsulation:2,changeDetection:0});let a=t;return a})(),en=(()=>{let t=class t{constructor(e,i,n,p){this.savedCartDetailsService=e,this.translation=i,this.vcr=n,this.launchDialogService=p,this.subscription=new ee,this.iconTypes=it,this.savedCart$=this.savedCartDetailsService.getCartDetails()}getCartName(e){return this.translation.translate("savedCartDetails.cartName").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getCartDescription(e){return this.translation.translate("savedCartDetails.cartDescription").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getCartId(e){return this.translation.translate("savedCartDetails.cartId").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}getDateSaved(e){return this.translation.translate("savedCartDetails.dateSaved").pipe(O(()=>!!e),g(i=>({title:i,text:[e??""]})))}getCartItems(e){return this.translation.translate("savedCartDetails.items").pipe(O(()=>!!e),g(i=>({title:i,text:[e.toString()]})))}getCartQuantity(e){return this.translation.translate("savedCartDetails.quantity").pipe(O(()=>!!e),g(i=>({title:i,text:[e.toString()]})))}getCartTotal(e){return this.translation.translate("savedCartDetails.total").pipe(O(()=>!!e),g(i=>({title:i,text:[e]})))}openDialog(e){let i=this.launchDialogService.openDialog("SAVED_CART",this.element,this.vcr,{cart:e,layoutOption:"edit"});i&&this.subscription.add(i.pipe($(1)).subscribe())}ngOnDestroy(){this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(St),f(Xe),f(Te),f(xe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-details-overview"]],viewQuery:function(i,n){if(i&1&&Ie(He,5),i&2){let p;be(p=Ae())&&(n.element=p.first)}},decls:2,vars:3,consts:[["element",""],[4,"ngIf"],[1,"cx-cart-summary"],[1,"container"],[1,"cx-summary-card"],[1,"cx-edit-container"],[3,"content"],[1,"cx-edit-cart",3,"click"],[3,"type"],[1,"cx-card-description"],[3,"content","truncateText","charactersLimit"]],template:function(i,n){i&1&&(D(0,Aa,28,29,"ng-container",1),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCart$))},dependencies:[re,bi,at,oe,ue,tt],encapsulation:2});let a=t;return a})(),tn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({imports:[se,Oe,Qe,Re,Ai,Li,nt,ot,Ii,Ui,pi.withConfig({cmsComponents:{SavedCartDetailsOverviewComponent:{component:en,guards:[Ve]},SavedCartDetailsItemsComponent:{component:Xa,guards:[Ve]},SavedCartDetailsActionComponent:{component:Ja,guards:[Ve]}}})]});let a=t;return a})(),an=(()=>{let t=class t{constructor(e,i,n,p){this.routing=e,this.savedCartService=i,this.vcr=n,this.launchDialogService=p,this.subscription=new ee,this.savedCarts$=this.savedCartService.getList().pipe(g(R=>R.sort((u,S)=>{let x=u.saveTime?new Date(u.saveTime).getTime():new Date().getTime();return(S.saveTime?new Date(S.saveTime).getTime():new Date().getTime())-x})))}ngOnInit(){this.isLoading$=this.savedCartService.getSavedCartListProcessLoading(),this.savedCartService.loadSavedCarts()}goToSavedCartDetails(e){this.routing.go({cxRoute:"savedCartsDetails",params:{savedCartId:e?.code}})}openDialog(e,i){let n=this.launchDialogService.openDialog("SAVED_CART",this.restoreButton,this.vcr,{cart:i,layoutOption:H.RESTORE});n&&this.subscription.add(n.pipe($(1)).subscribe()),e.stopPropagation()}ngOnDestroy(){this.savedCartService.clearSavedCarts(),this.savedCartService.clearSaveCart(),this.savedCartService.clearRestoreSavedCart(),this.subscription?.unsubscribe()}};t.\u0275fac=function(i){return new(i||t)(f(de),f(Z),f(Te),f(xe))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-list"]],viewQuery:function(i,n){if(i&1&&Ie(He,5),i&2){let p;be(p=Ae())&&(n.restoreButton=p.first)}},decls:2,vars:3,consts:[["loading",""],["noSavedCarts",""],["element",""],[4,"ngIf"],[4,"ngIf","ngIfElse"],["role","status"],[1,"cx-saved-cart-list-header"],[1,"table","cx-saved-cart-list-table"],[1,"cx-saved-cart-list-thead-mobile"],["scope","col"],["scope","col",1,"cx-saved-cart-list-th-qty"],["scope","col",1,"cx-saved-cart-list-th-total"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"cx-saved-cart-list-cart-name"],[1,"cx-table-label-mobile","cx-saved-cart-list-label"],[1,"cx-saved-cart-list-value",3,"routerLink"],[1,"cx-saved-cart-list-cart-id"],[1,"cx-saved-cart-list-date-saved"],[1,"cx-saved-cart-list-quantity"],[1,"cx-saved-cart-list-total"],[1,"cx-saved-cart-list-make-cart-active"],[1,"btn","btn-tertiary","cx-saved-cart-make-active",3,"click"],[1,"cx-saved-cart-list-no-saved-carts","row"],[1,"col-sm-12","col-md-6","col-lg-4"],[1,"cx-spinner"]],template:function(i,n){i&1&&(D(0,Oa,5,4,"ng-container",3),s(1,"async")),i&2&&v("ngIf",c(1,1,n.savedCarts$))},dependencies:[Jt,re,Je,rt,oe,et,ue,tt],encapsulation:2,changeDetection:0});let a=t;return a})(),nn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({providers:[_e({cmsComponents:{AccountSavedCartHistoryComponent:{component:an,guards:[Ve]}}})],imports:[se,Qe,Re,wi,Oe,ot]});let a=t;return a})(),rn=(()=>{let t=class t{constructor(e,i,n,p,R){this.importInfoService=e,this.userIdService=i,this.multiCartService=n,this.savedCartService=p,this.routingService=R,this.type=ct.SAVED_CART,this.savedCartId$=this.routingService.getRouterState().pipe(g(u=>u.state.params.savedCartId),De())}addEntries(e){return this.add(e).pipe(E(i=>this.importInfoService.getResults(i)),$(e.length))}getEntries(){return this.savedCartId$.pipe(E(e=>this.savedCartService.get(e)),g(e=>e?.entries??[]))}add(e){return ge([this.userIdService.takeUserId(),this.savedCartId$]).pipe(U(([i,n])=>this.multiCartService.addEntries(i,n,e)),g(([i,n])=>n))}};t.\u0275fac=function(i){return new(i||t)(h(lt),h(Fe),h(ye),h(Z),h(de))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),on=(()=>{let t=class t{constructor(e,i,n,p){this.importInfoService=e,this.userIdService=i,this.multiCartService=n,this.savedCartService=p,this.type=ct.NEW_SAVED_CART}addEntries(e,i){return this.add(e,i).pipe(U(n=>{this.importInfoService.getResults(n).pipe($(e.length),Qt(p=>p.statusCode===dt.UNKNOWN_IDENTIFIER||p.statusCode===dt.UNKNOWN_ERROR)).subscribe(p=>{p&&this.savedCartService.deleteSavedCart(n)})}),E(n=>this.importInfoService.getResults(n)),$(e.length))}add(e,i){return this.userIdService.takeUserId().pipe(E(n=>this.multiCartService.createCart({userId:n,extraData:{active:!1}}).pipe(g(p=>p.code),U(p=>{this.savedCartService.saveCart({cartId:p,saveCartName:i?.name,saveCartDescription:i?.description}),this.savedCartService.loadSavedCarts()}),Ne(Pe),Ut(()=>this.savedCartService.getSaveCartProcessLoading().pipe(O(p=>!p))),U(p=>this.multiCartService.addEntries(n,p,e)))))}};t.\u0275fac=function(i){return new(i||t)(h(lt),h(Fe),h(ye),h(Z))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),sn=(()=>{let t=class t{get descriptionsCharacterLeft(){return this.descriptionMaxLength-(this.form.get("description")?.value?.length||0)}handleClick(e){e.target.tagName===this.el.nativeElement.tagName&&this.close("Cross click")}constructor(e,i,n,p,R,u){this.launchDialogService=e,this.el=i,this.savedCartService=n,this.eventService=p,this.routingService=R,this.globalMessageService=u,this.subscription=new ee,this.savedCartFormType=H,this.iconTypes=it,this.descriptionMaxLength=250,this.nameMaxLength=50,this.isCloneSavedCart=!1,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0}}ngOnInit(){this.resetSavedCartStates(),this.isLoading$=this.savedCartService.getSaveCartProcessLoading(),this.isDisableDeleteButton$=Nt(this.eventService.get(qe).pipe($(1),g(()=>!0)),this.eventService.get(ki).pipe($(1),g(()=>!1))),this.isDisableRestoreButton$=ge([this.savedCartService.getCloneSavedCartProcessLoading(),this.savedCartService.getRestoreSavedCartProcessLoading()]).pipe(g(([e,i])=>e||i)),this.subscription.add(this.launchDialogService.data$.subscribe(e=>{this.cart=e.cart,this.layoutOption=e.layoutOption,this.build(this.cart)})),this.subscription.add(this.savedCartService.getSaveCartProcessSuccess().subscribe(e=>this.onComplete(e))),this.subscription.add(this.eventService.get(st).pipe($(1),g(()=>!0)).subscribe(e=>this.onComplete(e))),this.subscription.add(this.savedCartService.getRestoreSavedCartProcessSuccess().subscribe(e=>this.onComplete(e)))}saveOrEditCart(e){if(this.form.invalid)this.form.markAllAsTouched(),Vi.deepUpdateValueAndValidity(this.form);else{let i=this.form.get("name")?.value,n=this.form.get("description")?.value||"-";switch(this.layoutOption){case H.SAVE:{this.savedCartService.saveCart({cartId:e,saveCartName:i,saveCartDescription:n});break}case H.EDIT:{this.savedCartService.editSavedCart({cartId:e,saveCartName:i,saveCartDescription:n});break}}}}deleteCart(e){this.savedCartService.deleteSavedCart(e)}restoreSavedCart(e){this.isCloneSavedCart?this.savedCartService.cloneSavedCart(e,this.form.get("cloneName")?.value):this.savedCartService.restoreSavedCart(e)}close(e){this.launchDialogService.closeDialog(e)}onComplete(e){if(e)switch(this.layoutOption){case H.DELETE:{this.routingService.go({cxRoute:"savedCarts"}),this.globalMessageService.add({key:"savedCartDialog.deleteCartSuccess"},ve.MSG_TYPE_CONFIRMATION),this.close("Successfully deleted a saved cart");break}case H.SAVE:{this.close("Successfully saved cart"),this.savedCartService.clearSaveCart(),this.globalMessageService.add({key:"savedCartCartPage.messages.cartSaved",params:{cartName:this.form.get("name")?.value||this.cart?.code}},ve.MSG_TYPE_CONFIRMATION);break}case H.EDIT:{this.close("Successfully edited saved cart"),this.savedCartService.clearSaveCart(),this.globalMessageService.add({key:"savedCartDialog.editCartSuccess",params:{cartName:this.form.get("name")?.value||this.cart?.code}},ve.MSG_TYPE_CONFIRMATION);break}case H.RESTORE:{this.close("Successfully restored saved cart"),this.routingService.go({cxRoute:"savedCarts"}),this.resetSavedCartStates();break}}}toggleIsCloneSavedCart(){return this.isCloneSavedCart=!this.isCloneSavedCart}build(e){let i=new mi({});i.setControl("name",new ke("",[Ge.required,Ge.maxLength(this.nameMaxLength)])),i.setControl("description",new ke("",[Ge.maxLength(this.descriptionMaxLength)])),i.setControl("isCloneSavedCart",new ke("")),i.setControl("cloneName",new ke("")),this.form=i,this.patchData(e)}patchData(e){this.form.patchValue(q({},e))}resetSavedCartStates(){this.savedCartService.clearCloneSavedCart(),this.savedCartService.clearSaveCart(),this.savedCartService.clearRestoreSavedCart()}ngOnDestroy(){this.subscription?.unsubscribe(),this.close("close dialog")}};t.\u0275fac=function(i){return new(i||t)(f(xe),f(Wt),f(Z),f(fe),f(de),f(we))},t.\u0275cmp=ie({type:t,selectors:[["cx-saved-cart-form-dialog"]],hostBindings:function(i,n){i&1&&L("click",function(R){return n.handleClick(R)})},decls:1,vars:1,consts:[["saveAndEditCart",""],["isRestoreSavedCart",""],[4,"ngIf"],[1,"cx-saved-cart-form-dialog",3,"esc","cxFocus"],[1,"cx-saved-cart-form-container",3,"formGroup"],[1,"modal-header","cx-saved-cart-form-header"],[3,"ngSwitch"],[1,"cx-saved-cart-form-title","modal-title"],[4,"ngSwitchCase"],["type","button",1,"cx-saved-cart-form-close","close",3,"click","disabled"],["aria-hidden","true"],[3,"type"],[1,"cx-saved-cart-form-body"],[4,"ngIf","ngIfElse"],[1,"cx-saved-cart-form-subtitle"],[1,"cx-saved-cart-form-row"],[1,"cx-saved-cart-values-container"],[1,"cx-saved-cart-label"],[1,"cx-saved-cart-value"],[1,"cx-saved-cart-form-footer"],["type","button",1,"mr-2","btn","btn-secondary",3,"click"],[1,"cx-copy-saved-cart-row","form-check"],["id","cx-copy-saved-cart","type","checkbox",1,"cx-copy-saved-cart-input",3,"change","checked"],["for","cx-copy-saved-cart",1,"cx-copy-saved-cart-label"],["class","cx-copy-saved-cart-row",4,"ngIf"],[1,"cx-copy-saved-cart-row"],[1,"label-content"],["formControlName","cloneName","type","text",1,"form-control",3,"maxLength","placeholder"],["class","ml-2 btn btn-primary","type","button",3,"disabled","click",4,"ngIf"],["type","button",1,"ml-2","btn","btn-primary",3,"click","disabled"],[1,"cx-saved-carts-label","label-content"],["required","true","formControlName","name","required","","type","text",1,"form-control",3,"maxLength"],[3,"control"],[1,"cx-saved-carts-label-optional"],["formControlName","description","rows","5",1,"form-control",3,"maxLength"],[1,"cx-saved-carts-input-hint"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(i,n){i&1&&D(0,za,19,16,"ng-container",2),i&2&&v("ngIf",n.cart)},dependencies:[re,Xt,ei,Si,vi,ui,Ci,_i,gi,hi,Ri,at,yi,oe,ue],encapsulation:2,changeDetection:0});let a=t;return a})(),cn={launch:{SAVED_CART:{inline:!0,component:sn,dialogType:Di.DIALOG}}},dn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({imports:[se,fi,xi,Fi,Oe,nt,Ei]});let a=t;return a})(),ta=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({providers:[{provide:Zi,useExisting:rn},{provide:Ji,useExisting:on},_e(cn)],imports:[Re,Za,dn,nn,tn]});let a=t;return a})();var je=class{},aa=(()=>{let t=class t{constructor(e){this.adapter=e}get(e,i){return this.adapter.load(e,i)}getList(e){return this.adapter.loadList(e)}restoreSavedCart(e,i){return this.adapter.restoreSavedCart(e,i)}cloneSavedCart(e,i,n){return this.adapter.cloneSavedCart(e,i,n)}};t.\u0275fac=function(i){return new(i||t)(h(je))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),Ee="saved-cart-list",me="saved-cart-restore-cart",z="saved-cart-save-cart",Se="saved-cart-clone-cart",na="[Saved Cart] Load Saved Cart",ln="[Saved Cart] Load Saved Cart Success",pn="[Saved Cart] Load Saved Cart Fail",ra="[Saved Cart] Load Saved Carts",vn="[Saved Cart] Load Saved Carts Success",un="[Saved Cart] Load Saved Carts Fail",Cn="[Saved Cart] Clear Saved Carts",Mt="[Saved Cart] Restore Saved Cart",oa="[Saved Cart] Restore Saved Cart Success",sa="[Saved Cart] Restore Saved Cart Fail",mn="[Saved Cart] Clear Restore Saved Cart",Bt="[Saved Cart] Save Cart",ca="[Saved Cart] Save Cart Success",da="[Saved Cart] Save Cart Fail",Sn="[Saved Cart] Clear Save Cart",$t="[Saved Cart] Edit Saved Cart",la="[Saved Cart] Edit Saved Cart Success",pa="[Saved Cart] Edit Saved Cart Fail",jt="[Saved Cart] Clone Saved Cart",va="[Saved Cart] Clone Saved Cart Success",ua="[Saved Cart] Clone Saved Cart Fail",gn="[Saved Cart] Clear Clone Saved Cart",gt=class extends y.EntityLoadAction{constructor(t){super(Ye,t.cartId),this.payload=t,this.type=na}},ht=class extends y.EntitySuccessAction{constructor(t){super(Ye,t.cartId),this.payload=t,this.type=ln}},_t=class extends y.EntityFailAction{constructor(t){super(Ye,t.cartId,t?.error),this.payload=t,this.type=pn}},ze=class extends y.EntityLoadAction{constructor(t){super(b,Ee),this.payload=t,this.type=ra}},ft=class extends y.EntitySuccessAction{constructor(t){super(b,Ee),this.payload=t,this.type=vn}},xt=class extends y.EntityFailAction{constructor(t){super(b,Ee,t.error),this.payload=t,this.type=un}},yt=class extends y.EntityLoaderResetAction{constructor(){super(b,Ee),this.type=Cn}},Ke=class extends y.EntityLoadAction{constructor(t){super(b,me),this.payload=t,this.type=Mt}},Et=class extends y.EntitySuccessAction{constructor(t){super(b,me),this.payload=t,this.type=oa}},Dt=class extends y.EntityFailAction{constructor(t){super(b,me,t.error),this.payload=t,this.type=sa}},Tt=class extends y.EntityLoaderResetAction{constructor(){super(b,me),this.type=mn}},It=class extends y.EntityLoadAction{constructor(t){super(b,z),this.payload=t,this.type=Bt}},bt=class extends y.EntitySuccessAction{constructor(t){super(b,z),this.payload=t,this.type=ca}},At=class extends y.EntityFailAction{constructor(t){super(b,z,t.error),this.payload=t,this.type=da}},Lt=class extends y.EntityLoaderResetAction{constructor(){super(b,z),this.type=Sn}},Ze=class extends y.EntityLoadAction{constructor(t){super(b,z),this.payload=t,this.type=$t}},Rt=class extends y.EntitySuccessAction{constructor(t){super(b,z),this.payload=t,this.type=la}},Ft=class extends y.EntityFailAction{constructor(t){super(b,z,t.error),this.payload=t,this.type=pa}},wt=class extends y.EntityLoadAction{constructor(t){super(b,Se),this.payload=t,this.type=jt}},Vt=class extends y.EntitySuccessAction{constructor(t){super(b,Se),this.payload=t,this.type=va}},Ot=class extends y.EntityFailAction{constructor(t){super(b,Se,t.error),this.payload=t,this.type=ua}},kt=class extends y.EntityLoaderResetAction{constructor(){super(b,Se),this.type=gn}};var hn=(()=>{let t=class t{constructor(e,i,n,p){this.actionsSubject=e,this.eventService=i,this.stateEventService=n,this.multiCartService=p,this.register()}register(){this.registerRestoreSavedCartEvents(),this.registerSaveCartEvents(),this.registerEditSavedCartEvents(),this.registerCloneSavedCartEvents()}registerRestoreSavedCartEvents(){this.buildRestoreSavedCartEvents({action:Mt,event:Gi}),this.buildRestoreSavedCartEvents({action:oa,event:qi}),this.buildRestoreSavedCartEvents({action:sa,event:Wi})}registerSaveCartEvents(){this.buildSaveCartSuccessEvent({action:ca,event:Qi}),this.stateEventService.register({action:da,event:vt,factory:e=>pe(vt,X(q({},e.payload),{cartCode:e.payload.cartId}))}),this.stateEventService.register({action:Bt,event:pt,factory:e=>pe(pt,X(q({},e.payload),{cartCode:e.payload.cartId}))})}registerEditSavedCartEvents(){this.buildSaveCartSuccessEvent({action:la,event:Yi}),this.stateEventService.register({action:pa,event:Ct,factory:e=>pe(Ct,X(q({},e.payload),{cartCode:e.payload.cartId}))}),this.stateEventService.register({action:$t,event:ut,factory:e=>pe(ut,X(q({},e.payload),{cartCode:e.payload.cartId}))})}registerCloneSavedCartEvents(){this.buildRestoreSavedCartEvents({action:jt,event:Hi}),this.buildRestoreSavedCartEvents({action:va,event:zi}),this.buildRestoreSavedCartEvents({action:ua,event:Ki})}buildRestoreSavedCartEvents(e){let i=this.getAction(e.action).pipe(E(n=>K(n).pipe(he(this.multiCartService.getCart(n.payload.cartId)))),g(([n,p])=>pe(e.event,q(X(q({},n.payload),{cartCode:p.code,saveCartName:p.name,saveCartDescription:p.description}),p.saveTime&&{saveTime:p.saveTime}))));return this.eventService.register(e.event,i)}buildSaveCartSuccessEvent(e){let i=this.getAction(e.action).pipe(E(n=>K(n).pipe(he(this.multiCartService.getCart(n.payload.cartId)))),O(([,n])=>!!n),g(([n,p])=>pe(e.event,X(q({},n.payload),{cartCode:p.code,saveTime:p.saveTime}))));return this.eventService.register(e.event,i)}getAction(e){return this.actionsSubject.pipe(J(...[].concat(e)))}};t.\u0275fac=function(i){return new(i||t)(h(ii),h(fe),h(di),h(ye))},t.\u0275prov=Q({token:t,factory:t.\u0275fac,providedIn:"root"});let a=t;return a})(),_n=(()=>{let t=class t{constructor(e){}};t.\u0275fac=function(i){return new(i||t)(h(hn))},t.\u0275mod=M({type:t}),t.\u0275inj=k({});let a=t;return a})(),fn=(()=>{let t=class t{constructor(e,i,n,p,R){this.actions$=e,this.savedCartConnector=i,this.activeCartService=n,this.globalMessageService=p,this.cartConnector=R,this.logger=qt(oi),this.loadSavedCart$=ce(()=>this.actions$.pipe(J(na),g(u=>u.payload),E(({userId:u,cartId:S})=>this.savedCartConnector.get(u,S).pipe(E(x=>[new Ce.LoadCartSuccess({userId:u,cartId:S,cart:x}),new ht({userId:u,cartId:S})]),te(x=>K(new _t({userId:u,cartId:S,error:le(x,this.logger)}))))))),this.loadSavedCarts$=ce(()=>this.actions$.pipe(J(ra),g(u=>u.payload),E(({userId:u})=>this.savedCartConnector.getList(u).pipe(E(S=>[new Ce.LoadCartsSuccess(S),new ft({userId:u})]),te(S=>K(new xt({userId:u,error:le(S,this.logger)}))))))),this.restoreSavedCart$=ce(()=>this.actions$.pipe(J(Mt),g(u=>u.payload),he(this.activeCartService.getActive()),E(([{userId:u,cartId:S},x])=>{let V=[];return(x?.entries??[]).length>0&&x.code&&V.push(new Ze({userId:u,cartId:x.code,saveCartName:"",saveCartDescription:""})),this.savedCartConnector.restoreSavedCart(u,S).pipe(E(N=>(this.globalMessageService.add({key:(x?.entries??[]).length>0?"savedCartList.swapCartWithActiveCart":"savedCartList.swapCartNoActiveCart",params:{cartName:S,previousCartName:x.code}},ve.MSG_TYPE_CONFIRMATION),[...V,new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N,extraData:{active:!0}}),new Et({userId:u,cartId:S})])),te(N=>K(new Dt({userId:u,cartId:S,error:le(N,this.logger)}))))}))),this.saveCart$=ce(()=>this.actions$.pipe(J(Bt),g(u=>u.payload),E(({userId:u,cartId:S,saveCartName:x,saveCartDescription:V})=>this.cartConnector.save(u,S,x,V).pipe(E(N=>[new Ce.ClearCartState,new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N}),new bt({userId:u,cartId:S,saveCartName:x,saveCartDescription:V})]),te(N=>K(new At({userId:u,cartId:S,saveCartName:x,saveCartDescription:V,error:le(N,this.logger)}))))))),this.editSavedCart$=ce(()=>this.actions$.pipe(J($t),g(u=>u.payload),E(({userId:u,cartId:S,saveCartName:x,saveCartDescription:V})=>this.cartConnector.save(u,S,x,V).pipe(E(N=>[new Ce.LoadCartSuccess({userId:u,cartId:S,cart:N}),new Rt({userId:u,cartId:S,saveCartName:x,saveCartDescription:V})]),te(N=>K(new Ft({userId:u,cartId:S,saveCartName:x,saveCartDescription:V,error:le(N,this.logger)}))))))),this.cloneSavedCart$=ce(()=>this.actions$.pipe(J(jt),g(u=>u.payload),E(({userId:u,cartId:S,saveCartName:x})=>this.savedCartConnector.cloneSavedCart(u,S,x).pipe(E(V=>[new Vt({userId:u,cartId:S,saveCartName:x}),new Ke({userId:u,cartId:S}),new ze({userId:u})]),te(V=>K(new Ot({userId:u,cartId:S,saveCartName:x,error:le(V,this.logger)})))))))}};t.\u0275fac=function(i){return new(i||t)(h(ni),h(aa),h(We),h(we),h(Pi))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),xn=[fn],yn=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({imports:[ri.forFeature(xn)]});let a=t;return a})(),ia=(()=>{let t=class t{constructor(e,i,n,p,R){this.store=e,this.userIdService=i,this.userAccountFacade=n,this.multiCartService=p,this.eventService=R}loadSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.store.dispatch(new gt({userId:i,cartId:e})),error:()=>{}})}get(e){return this.getSavedCart(e).pipe(Ne(Pe),he(this.eventService.get(qe).pipe(Gt({}))),O(([i,n])=>!!i),U(([i,n])=>{if(Object.keys(n).length>0)return Pt;i.loading||i.success||i.error||this.loadSavedCart(e)}),O(([i])=>i.success||!!i.error),g(([i])=>i.value))}getSavedCart(e){return this.multiCartService.getCartEntity(e)}isStable(e){return this.multiCartService.isStable(e)}loadSavedCarts(){this.userIdService.takeUserId(!0).subscribe({next:e=>this.store.dispatch(new ze({userId:e})),error:()=>{}})}getList(){return this.getSavedCartList().pipe(he(this.getSavedCartListProcess()),U(([e,i])=>{i.loading||i.success||i.error||this.loadSavedCarts()}),g(([e,i])=>e),Ue({bufferSize:1,refCount:!0}))}getSavedCartList(){return ge([this.multiCartService.getCarts(),this.userAccountFacade.get()]).pipe(De(),g(([e,i])=>e.filter(n=>(i?.customerId!==void 0?n?.name!==`wishlist${i?.customerId}`:!0)&&!ji(n?.code)&&n?.saveTime)))}getSavedCartListProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(Ee)))}getSavedCartListProcess(){return this.store.pipe(j(P.getProcessStateFactory(Ee)))}clearSavedCarts(){this.store.dispatch(new yt)}restoreSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.store.dispatch(new Ke({userId:i,cartId:e})),error:()=>{}})}getRestoreSavedCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(me)))}getRestoreSavedCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(me)))}getRestoreSavedCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(me)))}clearRestoreSavedCart(){this.store.dispatch(new Tt)}deleteSavedCart(e){this.userIdService.takeUserId(!0).subscribe({next:i=>this.multiCartService.deleteCart(e,i),error:()=>{}})}saveCart({cartId:e,saveCartName:i,saveCartDescription:n}){this.userIdService.takeUserId(!0).subscribe({next:p=>this.store.dispatch(new It({userId:p,cartId:e,saveCartName:i,saveCartDescription:n})),error:()=>{}})}getSaveCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(z)))}getSaveCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(z)))}getSaveCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(z)))}clearSaveCart(){this.store.dispatch(new Lt)}editSavedCart({cartId:e,saveCartName:i,saveCartDescription:n}){this.userIdService.takeUserId(!0).subscribe({next:p=>this.store.dispatch(new Ze({userId:p,cartId:e,saveCartName:i,saveCartDescription:n})),error:()=>{}})}cloneSavedCart(e,i){this.userIdService.takeUserId(!0).subscribe({next:n=>this.store.dispatch(new wt({userId:n,cartId:e,saveCartName:i})),error:()=>{}})}getCloneSavedCartProcessLoading(){return this.store.pipe(j(P.getProcessLoadingFactory(Se)))}getCloneSavedCartProcessSuccess(){return this.store.pipe(j(P.getProcessSuccessFactory(Se)))}getCloneSavedCartProcessError(){return this.store.pipe(j(P.getProcessErrorFactory(Se)))}clearCloneSavedCart(){this.store.dispatch(new kt)}};t.\u0275fac=function(i){return new(i||t)(h(ai),h(Fe),h(Oi),h(ye),h(fe))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),En=[ia,{provide:Z,useExisting:ia}],Ca=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({providers:[aa,...En],imports:[yn,_n]});let a=t;return a})();var Dn=(()=>{let t=class t{constructor(e,i,n){this.http=e,this.occEndpoints=i,this.converter=n}load(e,i){return this.http.get(this.getSavedCartEndpoint(e,i)).pipe(g(n=>n.savedCartData),this.converter.pipeable(Me))}loadList(e){return this.http.get(this.getSavedCartListEndpoint(e)).pipe(g(i=>i.carts??[]),this.converter.pipeableMany(Me))}restoreSavedCart(e,i){return this.http.patch(this.getRestoreSavedCartEndpoint(e,i),i).pipe(g(n=>n.savedCartData),this.converter.pipeable(Me))}cloneSavedCart(e,i,n){return this.http.post(this.getCloneSavedCartEndpoint(e,i,n),i).pipe(g(p=>p.savedCartData),this.converter.pipeable(Me))}getSavedCartEndpoint(e,i){return this.occEndpoints.buildUrl("savedCart",{urlParams:{userId:e,cartId:i}})}getSavedCartListEndpoint(e){return this.occEndpoints.buildUrl("savedCarts",{urlParams:{userId:e}})}getRestoreSavedCartEndpoint(e,i){return this.occEndpoints.buildUrl("restoreSavedCart",{urlParams:{userId:e,cartId:i}})}getCloneSavedCartEndpoint(e,i,n){return this.occEndpoints.buildUrl("cloneSavedCart",{urlParams:{userId:e,cartId:i,saveCartName:n}})}};t.\u0275fac=function(i){return new(i||t)(h(ti),h(ci),h(li))},t.\u0275prov=Q({token:t,factory:t.\u0275fac});let a=t;return a})(),Tn={backend:{occ:{endpoints:{savedCarts:"/users/${userId}/carts?savedCartsOnly=true&fields=carts(DEFAULT,potentialProductPromotions,appliedProductPromotions,potentialOrderPromotions,appliedOrderPromotions,entries(totalPrice(formattedValue),product(images(FULL),stock(FULL)),basePrice(formattedValue,value),updateable),totalPrice(formattedValue),totalItems,totalPriceWithTax(formattedValue),totalDiscounts(value,formattedValue),subTotal(formattedValue),totalUnitCount,deliveryItemsQuantity,deliveryCost(formattedValue),totalTax(formattedValue, value),pickupItemsQuantity,net,appliedVouchers,productDiscounts(formattedValue),saveTime,user,name,description)",savedCart:"/users/${userId}/carts/${cartId}/savedcart",restoreSavedCart:"/users/${userId}/carts/${cartId}/restoresavedcart",cloneSavedCart:"/users/${userId}/carts/${cartId}/clonesavedcart?name=${saveCartName}"}}}},ma=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({providers:[_e(Tn),{provide:je,useClass:Dn}],imports:[se]});let a=t;return a})();var Sr=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=M({type:t}),t.\u0275inj=k({imports:[Ca,ma,ta]});let a=t;return a})();export{Sr as SavedCartModule};
