import{c as B}from"./chunk-AOSSJKBV.js";import{c as Zt}from"./chunk-7ASOYV3X.js";import{a as w,b as $,e as j,i as ee,j as ie}from"./chunk-ZR76AGJA.js";import"./chunk-64EE32CY.js";import{C as te,O as U}from"./chunk-LFKNHGJI.js";import{La as Kt,Y as Vt,Z as Gt,ga as Yt,ia as zt,ib as Xt,jb as F,ka as Qt,la as qt,va as Jt}from"./chunk-XOYCCVJR.js";import{Aa as Et,Ab as ot,Ba as X,Bb as v,Ca as Z,Cb as st,Cd as mt,Cf as ft,Df as Pt,Ha as St,Hb as Ft,I as E,Jb as at,L as D,Ld as Nt,M as yt,Ob as d,Oc as dt,P as Lt,Pa as s,Pb as m,Pc as Mt,Qa as tt,Rd as ut,S as z,Tb as ct,Tc as S,Uc as Dt,Vc as W,Wc as Ot,Yd as ht,_a as I,ab as p,cd as Ut,ed as $t,fa as x,gb as l,hb as c,hc as lt,hf as kt,ia as Q,ib as Wt,ic as pt,if as Rt,jb as et,je as O,ka as q,kb as it,lb as Tt,m as _t,mb as nt,md as jt,na as J,nc as At,oa as L,ob as rt,pb as u,q as M,qa as _,ra as Ct,tc as bt,v as y,va as K,ve as Ht,w as vt,wa as C,wd as T,yb as wt,yd as Bt,zb as h}from"./chunk-EVGLS3CH.js";var me=["cx-wish-list-item",""],re=e=>({cxRoute:"product",params:e});function ue(e,t){if(e&1&&(l(0,"div",13)(1,"a",14),d(2,"cxUrl"),h(3),c()()),e&2){let r=u();s(),p("routerLink",m(2,2,at(4,re,r.cartEntry.product))),s(2),ot(r.cartEntry.product==null?null:r.cartEntry.product.name)}}function he(e,t){if(e&1&&(l(0,"div",15),h(1),d(2,"cxTranslate"),c()),e&2){let r=u();s(),st(" ",m(2,2,"cartItems.id")," ",r.cartEntry.product==null?null:r.cartEntry.product.code," ")}}function fe(e,t){if(e&1&&(l(0,"div",19),h(1),c()),e&2){let r=u().$implicit;s(),st(" ",r.name,": ",r.value," ")}}function Ie(e,t){if(e&1&&(l(0,"div",17),I(1,fe,2,2,"div",18),c()),e&2){let r=t.$implicit;s(),p("ngIf",r.name&&r.value)}}function ge(e,t){if(e&1&&(et(0),I(1,Ie,2,1,"div",16),it()),e&2){let r=u();s(),p("ngForOf",r.cartEntry.product==null||r.cartEntry.product.baseOptions[0]==null||r.cartEntry.product.baseOptions[0].selected==null?null:r.cartEntry.product.baseOptions[0].selected.variantOptionQualifiers)}}function xe(e,t){if(e&1&&(l(0,"div",23),h(1),c()),e&2){let r=u(2);s(),v(" ",r.cartEntry.basePrice==null?null:r.cartEntry.basePrice.formattedValue," ")}}function _e(e,t){if(e&1&&(l(0,"td",20)(1,"div",21),h(2),d(3,"cxTranslate"),c(),I(4,xe,2,1,"div",22),c()),e&2){let r=u();s(2),v(" ",m(3,2,"cartItems.itemPrice")," "),s(2),p("ngIf",r.cartEntry.basePrice)}}function ve(e,t){e&1&&Tt(0,24)}function ye(e,t){e&1&&(l(0,"span",25),h(1),d(2,"cxTranslate"),c()),e&2&&(s(),v(" ",m(2,1,"addToCart.outOfStock")," "))}function Le(e,t){if(e&1){let r=nt();l(0,"button",26),d(1,"cxTranslate"),rt("click",function(){X(r);let n=u();return Z(n.removeEntry(n.cartEntry))}),h(2),d(3,"cxTranslate"),c()}if(e&2){let r=u();p("cxAtMessage",m(1,3,"wishlist.itemRemoved"))("disabled",r.isLoading),s(2),v(" ",m(3,5,"common.remove")," ")}}function Ce(e,t){if(e&1){let r=nt();l(0,"tr",11),d(1,"async"),rt("remove",function(n){X(r);let o=u(3);return Z(o.removeEntry(n))}),c()}if(e&2){let r=t.$implicit,i=u(3);p("cartEntry",r)("isLoading",m(1,2,i.loading$))}}function Ee(e,t){if(e&1&&(l(0,"table",3)(1,"caption",4),h(2),d(3,"cxTranslate"),c(),l(4,"thead")(5,"tr",5)(6,"th",6),h(7),d(8,"cxTranslate"),c(),l(9,"th",7),h(10),d(11,"cxTranslate"),c(),l(12,"th",8),h(13),d(14,"cxTranslate"),c()()(),l(15,"tbody",9),I(16,Ce,2,4,"tr",10),c()()),e&2){let r=u().ngIf;s(2),v(" ",m(3,5,"wishlist.caption")," "),s(5),v(" ",m(8,7,"cartItems.description")," "),s(3),v(" ",m(11,9,"cartItems.itemPrice")," "),s(3),v(" ",m(14,11,"cartItems.actions")," "),s(3),p("ngForOf",r==null?null:r.entries)}}function Se(e,t){if(e&1&&(et(0),I(1,Ee,17,13,"table",2),it()),e&2){let r=t.ngIf;u();let i=wt(3);s(),p("ngIf",(r==null||r.entries==null?null:r.entries.length)>0)("ngIfElse",i)}}function We(e,t){e&1&&(l(0,"h2"),h(1),d(2,"cxTranslate"),c()),e&2&&(s(),ot(m(2,1,"wishlist.empty")))}var Te=(()=>{let t=class t{constructor(i){this.productListItemContextSource=i,this.isLoading=!1,this.remove=new St}ngOnChanges(i){i?.cartEntry&&this.productListItemContextSource.product$.next(this.cartEntry.product)}removeEntry(i){this.remove.emit(i)}};t.\u0275fac=function(n){return new(n||t)(tt(F))},t.\u0275cmp=K({type:t,selectors:[["","cx-wish-list-item",""],["cx-wish-list-item"]],inputs:{isLoading:"isLoading",cartEntry:"cartEntry"},outputs:{remove:"remove"},features:[Ft([F,{provide:Xt,useExisting:F}]),Et],attrs:me,decls:15,vars:12,consts:[["outOfStock",""],["role","cell"],[1,"cx-table-item-container"],["tabindex","-1",3,"routerLink"],["format","thumbnail",3,"container"],[1,"cx-info"],["class","cx-name",4,"ngIf"],["class","cx-code",4,"ngIf"],[4,"ngIf"],["role","cell","class","cx-price",4,"ngIf"],["role","cell",1,"cx-actions"],["cxInnerComponentsHost","",4,"ngIf"],["class","link cx-action-link cx-remove-btn",3,"cxAtMessage","disabled","click",4,"ngIf"],[1,"cx-name"],[1,"cx-link",3,"routerLink"],[1,"cx-code"],["class","cx-property",4,"ngFor","ngForOf"],[1,"cx-property"],["class","cx-label",4,"ngIf"],[1,"cx-label"],["role","cell",1,"cx-price"],[1,"cx-mobile-header"],["class","cx-value",4,"ngIf"],[1,"cx-value"],["cxInnerComponentsHost",""],[1,"cx-out-of-stock"],[1,"link","cx-action-link","cx-remove-btn",3,"click","cxAtMessage","disabled"]],template:function(n,o){n&1&&(l(0,"td",1)(1,"div",2)(2,"a",3),d(3,"cxUrl"),Wt(4,"cx-media",4),c(),l(5,"div",5),I(6,ue,4,6,"div",6)(7,he,3,4,"div",7),c()(),I(8,ge,2,1,"ng-container",8),c(),I(9,_e,5,4,"td",9),l(10,"td",10),I(11,ve,1,0,"ng-container",11)(12,ye,3,3,"ng-template",null,0,ct)(14,Le,4,7,"button",12),c()),n&2&&(s(2),p("routerLink",m(3,8,at(10,re,o.cartEntry.product))),s(2),p("container",o.cartEntry.product==null||o.cartEntry.product.images==null?null:o.cartEntry.product.images.PRIMARY),s(2),p("ngIf",o.cartEntry.product==null?null:o.cartEntry.product.name),s(),p("ngIf",o.cartEntry.product==null?null:o.cartEntry.product.code),s(),p("ngIf",o.cartEntry.product==null||o.cartEntry.product.baseOptions==null?null:o.cartEntry.product.baseOptions.length),s(),p("ngIf",o.cartEntry.basePrice),s(2),p("ngIf",o.cartEntry.updateable),s(3),p("ngIf",o.cartEntry.updateable))},dependencies:[Yt,lt,pt,Qt,Vt,Ut,ft,kt],encapsulation:2,changeDetection:0});let e=t;return e})(),we=(()=>{let t=class t{constructor(i){this.wishListFacade=i,this.wishList$=this.wishListFacade.getWishList(),this.loading$=this.wishListFacade.getWishListLoading()}removeEntry(i){this.wishListFacade.removeEntry(i)}};t.\u0275fac=function(n){return new(n||t)(tt(B))},t.\u0275cmp=K({type:t,selectors:[["cx-wish-list"]],decls:4,vars:3,consts:[["emptyWishList",""],[4,"ngIf"],["role","table",4,"ngIf","ngIfElse"],["role","table"],[1,"cx-visually-hidden"],["role","row",1,"cx-item-list-header","cx-wish-list-header"],["role","columnheader",1,"cx-item-list-desc"],["role","columnheader",1,"cx-item-list-price"],["role","columnheader",1,"cx-item-list-actions"],[1,"cx-item-list-items"],["cx-wish-list-item","","role","row","class","cx-item-list-row cx-wish-list-item-row",3,"cartEntry","isLoading","remove",4,"ngFor","ngForOf"],["cx-wish-list-item","","role","row",1,"cx-item-list-row","cx-wish-list-item-row",3,"remove","cartEntry","isLoading"]],template:function(n,o){n&1&&(I(0,Se,2,2,"ng-container",1),d(1,"async"),I(2,We,3,3,"ng-template",null,0,ct)),n&2&&p("ngIf",m(1,1,o.wishList$))},dependencies:[lt,pt,Te,At,ft],encapsulation:2});let e=t;return e})(),oe=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=C({type:t}),t.\u0275inj=L({providers:[jt({cmsComponents:{WishListComponent:{component:we,data:{composition:{inner:["ProductAddToCartComponent"]}},guards:[Ht]}}})],imports:[zt,bt,Pt,Jt,qt,Gt,$t,Kt,Rt]});let e=t;return e})();var ae="[Wish List] Create Wish List",Fe="[Wish List] Create Wish List Fail",A="[Wish List] Create Wish List Success",ce="[Wish List] Load Wish List",b="[Wish List] Load Wish List Success",Ae="[Wish List] Load Wish List Fail",N=class{constructor(t){this.payload=t,this.type=ae}},It=class extends T.EntitySuccessAction{constructor(t){super(w,t.cartId),this.payload=t,this.type=A}},gt=class extends T.EntityFailAction{constructor(t){super(w,t.cartId,t.error),this.payload=t,this.type=Fe}},xt=class extends T.EntityLoadAction{constructor(t){super(w,t.cartId),this.payload=t,this.type=ce}},H=class extends T.EntitySuccessAction{constructor(t){super(w,t.cartId),this.payload=t,this.type=b}},k=class extends T.EntityFailAction{constructor(t){super(w,t.cartId,t.error),this.payload=t,this.type=Ae}};function be(e){return`wishlist${e}`}var se=(()=>{let t=class t{constructor(i,n,o,R){this.store=i,this.userAccountFacade=n,this.multiCartFacade=o,this.userIdService=R}createWishList(i,n,o){this.store.dispatch(new N({userId:i,name:n,description:o}))}getWishList(){return vt([this.getWishListId(),this.userAccountFacade.get(),this.userIdService.getUserId()]).pipe(z(),Q(([i,n,o])=>{!i&&o!==Bt&&n?.customerId&&this.loadWishList(o,n.customerId)}),E(([i])=>!!i),x(([i])=>this.multiCartFacade.getCart(i)))}loadWishList(i,n){this.store.dispatch(new xt({userId:i,cartId:be(n)}))}addEntry(i){this.getWishListIdWithUserId().subscribe(([n,o])=>this.multiCartFacade.addEntry(o,n,i,1))}removeEntry(i){this.getWishListIdWithUserId().subscribe(([n,o])=>this.multiCartFacade.removeEntry(o,n,i.entryNumber))}getWishListLoading(){return this.getWishListId().pipe(x(i=>this.multiCartFacade.isStable(i).pipe(y(n=>!n))))}getWishListId(){return this.multiCartFacade.getCartIdByType(U.WISH_LIST)}getWishListIdWithUserId(){return this.getWishListId().pipe(z(),q(this.userIdService.getUserId(),this.userAccountFacade.get()),Q(([i,n,o])=>{!i&&o?.customerId&&this.loadWishList(n,o.customerId)}),E(([i])=>!!i),y(([i,n])=>[i,n]),Lt(1))}};t.\u0275fac=function(n){return new(n||t)(_(dt),_(Zt),_(te),_(mt))},t.\u0275prov=J({token:t,factory:t.\u0275fac});let e=t;return e})(),Me=[se,{provide:B,useExisting:se}],De=(()=>{let t=class t{constructor(i,n,o,R){this.actions$=i,this.cartConnector=n,this.userIdService=o,this.store=R,this.logger=Ct(Nt),this.createWishList$=S(()=>this.actions$.pipe(W(ae),y(a=>a.payload),x(a=>this.cartConnector.create(a.userId).pipe(x(g=>this.cartConnector.save(a.userId,g.code??"",a.name,a.description).pipe(x(f=>[new It({cart:f,cartId:j(f,a.userId)})]),D(f=>M([new gt({cartId:g.code??"",error:O(f,this.logger)})])))))))),this.loadWishList$=S(()=>this.actions$.pipe(W(ce),y(a=>a.payload),yt(a=>{let{userId:g,cartId:f}=a;return this.cartConnector.loadAll(g).pipe(x(P=>{let V=f,G=P.find(pe=>pe.name===V),Y=[];return Y.push(G?new H({cart:G,cartId:j(G,g)}):new N({userId:g,name:V})),Y.push(new $.RemoveCart({cartId:V})),Y}),D(P=>M([new k({cartId:f,error:O(P,this.logger)})])))}))),this.resetWishList$=S(()=>this.actions$.pipe(W(ht.LANGUAGE_CHANGE,ht.CURRENCY_CHANGE),q(this.userIdService.getUserId(),this.store.pipe(E(a=>!!a.cart),Mt(ie.getCartIdByTypeFactory(U.WISH_LIST)))),x(([,a,g])=>g?this.cartConnector.load(a,g).pipe(x(f=>[new H({cart:f??{},cartId:j(f,a)})]),D(f=>M([new k({cartId:g,error:O(f,this.logger)})]))):_t))),this.setWishListId$=S(()=>this.actions$.pipe(W(A,b),y(a=>{switch(a.type){case A:case b:return new $.SetCartTypeIndex({cartType:U.WISH_LIST,cartId:a.meta.entityId})}}),E(ut))),this.setWishListData$=S(()=>this.actions$.pipe(W(A,b),y(a=>{switch(a.type){case A:case b:return new $.SetCartData({cart:a.payload.cart,cartId:a.payload.cartId})}}),E(ut)))}};t.\u0275fac=function(n){return new(n||t)(_(Dt),_(ee),_(mt),_(dt))},t.\u0275prov=J({token:t,factory:t.\u0275fac});let e=t;return e})(),Oe=[De],Ue=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=C({type:t}),t.\u0275inj=L({imports:[Ot.forFeature(Oe)]});let e=t;return e})(),le=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=C({type:t}),t.\u0275inj=L({providers:[...Me],imports:[Ue]});let e=t;return e})();var Ii=(()=>{let t=class t{};t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=C({type:t}),t.\u0275inj=L({imports:[oe,le]});let e=t;return e})();export{Ii as WishListModule};
