import './polyfills.server.mjs';
import{B as xe,C as ve,D as Ce,E as ie,F as ne,L as ye,M as F,O as N,P as be,T as we,ba as oe,ca as ae,ka as j,la as Te,ma as Pe,tb as Me}from"./chunk-5IJ5Z3N4.mjs";import{D as ee,Vb as Y,Wb as Ie,ja as te,u as fe}from"./chunk-QG3PMDLA.mjs";import{Cd as _e,Dc as g,Eb as se,Ec as h,F as H,Fa as R,Fc as ge,Hb as me,Ic as J,J as X,Jb as de,L as C,Ob as u,Pb as U,Qa as P,Qb as c,Ra as k,Sb as q,Vc as he,Wb as l,Xb as p,Yb as v,Za as f,Zb as D,_a as I,_b as z,a as A,ac as y,ba as ce,cc as _,dc as s,eb as M,fb as B,g as w,jc as S,kc as V,lc as Z,mc as K,nc as le,pc as ue,q as re,qd as $,sa as W,vb as d,vd as L,wa as E,wb as x,x as O,y as Q,yc as pe,za as T}from"./chunk-JSDTXUAI.mjs";import"./chunk-GHFNAT2I.mjs";function Re(n,i){if(n&1&&v(0,"cx-carousel",3),n&2){let a=s().ngIf;s();let e=K(3);c("items",a)("hideIndicators",!1)("template",e)}}function ke(n,i){if(n&1&&(D(0),u(1,Re,1,3,"cx-carousel",2),z()),n&2){let a=i.ngIf;d(),c("ngIf",a.length)}}function Se(n,i){if(n&1){let a=y();l(0,"cx-media",4),g(1,"async"),_("focus",function(){let t=f(a).item,o=s();return I(o.openImage(t.container))}),p()}if(n&2){let a=i.item,e=s();q("is-active",h(1,3,e.isActive(a.container))),c("container",a.container)}}var Ve=["defaultImage"],Ze=["zoomContainer"],Ae=["zoomedImage"];function Oe(n,i){if(n&1){let a=y();l(0,"button",11),_("click",function(){let t=f(a).ngIf,o=s(3);return I(o.openImage(t.container))}),v(1,"cx-icon",12),p()}if(n&2){let a=s(3);d(),c("type",a.iconType.CARET_LEFT)}}function Be(n,i){if(n&1&&v(0,"cx-media",13,0),n&2){let a=s(2).ngIf;c("container",a)}}function $e(n,i){if(n&1){let a=y();l(0,"div",14,1)(2,"cx-media",15,2),_("mousemove",function(t){f(a);let o=s(3);return I(o.pointerMove(t))})("touchmove",function(t){f(a);let o=s(3);return I(o.touchMove(t))})("touchend",function(){f(a);let t=s(3);return I(t.clearTouch())}),p()()}if(n&2){let a=s(2).ngIf;d(2),c("container",a)}}function Le(n,i){if(n&1){let a=y();l(0,"button",11),_("click",function(){let t=f(a).ngIf,o=s(3);return I(o.openImage(t.container))}),v(1,"cx-icon",12),p()}if(n&2){let a=s(3);d(),c("type",a.iconType.CARET_RIGHT)}}function Ye(n,i){if(n&1&&(l(0,"div",6)(1,"div",7),u(2,Oe,2,1,"button",8),g(3,"async"),p(),u(4,Be,2,1,"cx-media",9)(5,$e,4,1,"div",10),l(6,"div",7),u(7,Le,2,1,"button",8),g(8,"async"),p()()),n&2){let a=i.ngIf,e=s(2);d(2),c("ngIf",h(3,4,e.getPreviousProduct(a))),d(2),c("ngIf",!e.isZoomed),d(),c("ngIf",e.isZoomed),d(2),c("ngIf",h(8,6,e.getNextProduct(a)))}}function Fe(n,i){if(n&1&&(D(0),u(1,Ye,9,8,"div",5),g(2,"async"),z()),n&2){let a=s();d(),c("ngIf",h(2,1,a.thumbnails$))}}var Ne=["expandButton"],je=n=>({product:n});function Ge(n,i){if(n&1){let a=y();D(0),l(1,"cx-media",2),_("click",function(){f(a);let t=s();return I(t.triggerZoom(!0))}),p(),l(2,"cx-product-image-zoom-trigger",3),_("dialogClose",function(){f(a);let t=s();return I(t.triggerZoom(!1))}),p(),z()}if(n&2){let a=i.ngIf,e=s();d(),c("container",a),d(),c("expandImage",e.expandImage.value)("galleryIndex",e.selectedIndex)}}function Qe(n,i){if(n&1&&(v(0,"cx-carousel",5),g(1,"cxTranslate")),n&2){let a=s().ngIf,e=s().ngIf;s();let t=K(5);c("items",e)("hideIndicators",!1)("template",t),U("aria-label",ge(1,4,"carousel.carouselForProduct",pe(7,je,a.name)))}}function He(n,i){if(n&1&&(D(0),u(1,Qe,2,9,"cx-carousel",4),z()),n&2){let a=s().ngIf;d(),c("ngIf",a.length)}}function Xe(n,i){if(n&1&&(D(0),u(1,He,2,1,"ng-container",1),g(2,"async"),z()),n&2){let a=s();d(),c("ngIf",h(2,1,a.product$))}}function We(n,i){if(n&1){let a=y();l(0,"cx-media",6),g(1,"async"),_("focus",function(){let t=f(a).item,o=s();return I(o.openImage(t.container))}),p()}if(n&2){let a=i.item,e=s();q("is-active",h(1,3,e.isActive(a.container))),c("container",a.container)}}var Ue=(()=>{let i=class i{constructor(){this.mainMediaContainer=new w({}),this.productImage=new B,this.subscription=new A}ngOnInit(){this.subscription.add(this.activeThumb.subscribe(e=>{this.mainMediaContainer.next(e)}))}openImage(e){this.mainMediaContainer.next(e),typeof e.zoom?.galleryIndex=="number"&&this.productImage.emit({image:e,index:e.zoom.galleryIndex})}isActive(e){return this.mainMediaContainer.asObservable().pipe(C(te),O(t=>t.zoom?.url&&e.zoom?.url&&t.zoom.url===e.zoom.url))}ngOnDestroy(){this.subscription.unsubscribe()}};i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=P({type:i,selectors:[["cx-product-image-zoom-thumbnails"]],inputs:{thumbs$:"thumbs$",activeThumb:"activeThumb"},outputs:{productImage:"productImage"},decls:4,vars:3,consts:[["thumb",""],[4,"ngIf"],["class","thumbs","itemWidth","70px",3,"items","hideIndicators","template",4,"ngIf"],["itemWidth","70px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0",3,"focus","container"]],template:function(t,o){t&1&&(u(0,ke,2,1,"ng-container",1),g(1,"async"),u(2,Se,2,5,"ng-template",null,0,J)),t&2&&c("ngIf",h(1,1,o.thumbs$))},dependencies:[ae,$,j,L],encapsulation:2,changeDetection:0});let n=i;return n})(),qe=(()=>{let i=class i{get defaultImage(){return this._defaultImage}set defaultImage(e){e&&(this._defaultImage=e,this.defaultImageReady.next(!0))}get zoomImage(){return this._zoomImage}set zoomImage(e){e&&(this._zoomImage=e,this.zoomReady.next(!0))}constructor(e,t,o,r){this.currentProductService=e,this.renderer=t,this.cdRef=o,this.breakpointService=r,this.iconType=F,this.mainMediaContainer=new w(null),this.defaultImageReady=new w(!1),this.zoomReady=new w(!1),this.subscription=new A,this.mainMediaContainer$=this.mainMediaContainer.asObservable(),this.defaultImageReady$=this.defaultImageReady.asObservable(),this.zoomReady$=this.zoomReady.asObservable(),this.activeThumb=new B,this.defaultImageClickHandler$=this.defaultImageReady$.pipe(C(Boolean),E(m=>X(...this.clickOrDoubleClick(this.defaultImage)).pipe(T(()=>this.zoom())))),this.zoomImageClickHandler$=this.zoomReady$.pipe(C(Boolean),E(m=>X(...this.clickOrDoubleClick(this.zoomImage)).pipe(T(()=>this.zoom())))),this.startCoords=null,this.left=0,this.top=0,this.isZoomed=!1,this.product$=this.currentProductService.getProduct().pipe(C(te),ce(),T(m=>{if(this.galleryIndex){let b=Array.isArray(m.images?.GALLERY)?m.images?.GALLERY.find(G=>G.zoom?.galleryIndex===this.galleryIndex):m.images?.GALLERY;this.mainMediaContainer.next(b||null)}else this.mainMediaContainer.next(m.images?.PRIMARY?m.images.PRIMARY:{})}),W(1)),this.thumbnails$=this.product$.pipe(O(m=>this.createThumbs(m)),W(1)),this.mainImage$=Q([this.product$,this.mainMediaContainer$]).pipe(O(([,m])=>m))}ngOnInit(){this.subscription.add(this.defaultImageClickHandler$.subscribe()),this.subscription.add(this.zoomImageClickHandler$.subscribe())}openImage(e){this.mainMediaContainer.next(e),this.activeThumb.emit(e)}getActive(){return Array.isArray(this.mainMediaContainer.value)?this.mainMediaContainer.value[0].thumbnail?.galleryIndex||0:this.mainMediaContainer?.value?.thumbnail?.galleryIndex||0}getPreviousProduct(e){let t=this.getActive();return t===0?e[t]:e[t-1]}getNextProduct(e){let t=this.getActive();return t===e.length-1?e[t]:e[t+1]}zoom(){this.isZoomed=!this.isZoomed,this.startCoords=null,this.left=0,this.top=0,this.cdRef.markForCheck()}touchMove(e){let t=e.touches[0]||e.changedTouches[0],o=this.zoomedImage?.nativeElement?.getBoundingClientRect(),r=this.zoomedImage?.nativeElement?.firstChild;this.startCoords||(this.startCoords={x:t.clientX,y:t.clientY}),this.left+=t.clientX-this.startCoords.x,this.top+=t.clientY-this.startCoords.y,this.moveImage(this.left,this.top,o,r),this.startCoords={x:t.clientX,y:t.clientY}}clearTouch(){this.startCoords=null}pointerMove(e){let t=this.zoomedImage.nativeElement.getBoundingClientRect(),o=this.zoomedImage.nativeElement.firstChild,{positionX:r,positionY:m}=this.calculatePointerMovePosition(this.zoomedImage,e.clientX,e.clientY);this.moveImage(r,m,t,o)}changeImage(e){this.mainMediaContainer.next(e.image)}moveImage(e,t,o,r){let{x:m,y:b}=this.handleOutOfBounds(e,t,r,o);r&&(this.renderer.setStyle(r,"left",m+"px"),this.renderer.setStyle(r,"top",b+"px"))}ngOnDestroy(){this.subscription.unsubscribe()}clickOrDoubleClick(e){return[H(e.nativeElement,"click").pipe(E(()=>this.breakpointService.isUp(ie.md)),C(Boolean)),H(e.nativeElement,"dblclick").pipe(E(()=>this.breakpointService.isDown(ie.lg)),C(Boolean))]}createThumbs(e){return!e.images||!e.images.GALLERY||Array.isArray(e.images.GALLERY)&&e.images.GALLERY.length<2?[]:e.images.GALLERY.map(o=>re({container:o}))}handleOutOfBounds(e,t,o,r){return t<=-o?.height+60&&(t=-o?.height+60),t>=r?.height-60&&(t=r?.height-60),e<=-o?.width-r?.width/2+60&&(e=-o?.width-r?.width/2+60),e>=o?.width+r?.width/2-60&&(e=o?.width+r?.width/2-60),{x:e,y:t}}calculatePointerMovePosition(e,t,o){let r=e.nativeElement.getBoundingClientRect(),m=t-r.left,b=o-r.top,G=-m+e.nativeElement.clientWidth/2,ze=-b+e.nativeElement.clientHeight/2;return{positionX:G,positionY:ze}}};i.\u0275fac=function(t){return new(t||i)(x(oe),x(se),x(he),x(we))},i.\u0275cmp=P({type:i,selectors:[["cx-product-image-zoom-view"]],viewQuery:function(t,o){if(t&1&&(S(Ve,5,M),S(Ze,5,M),S(Ae,5,M)),t&2){let r;V(r=Z())&&(o.defaultImage=r.first),V(r=Z())&&(o.zoomImage=r.first),V(r=Z())&&(o.zoomedImage=r.first)}},inputs:{galleryIndex:"galleryIndex"},decls:3,vars:5,consts:[["defaultImage",""],["zoomContainer",""],["zoomedImage",""],[4,"ngIf"],[3,"productImage","thumbs$","activeThumb"],["class","cx-main-image-group",4,"ngIf"],[1,"cx-main-image-group"],[1,"cx-navigate-image"],["class","btn btn-link",3,"click",4,"ngIf"],["class","cx-default-image-zoom",3,"container",4,"ngIf"],["class","cx-zoom-container",4,"ngIf"],[1,"btn","btn-link",3,"click"],[3,"type"],[1,"cx-default-image-zoom",3,"container"],[1,"cx-zoom-container"],[1,"cx-image-zoomed",3,"mousemove","touchmove","touchend","container"]],template:function(t,o){t&1&&(u(0,Fe,3,3,"ng-container",3),g(1,"async"),l(2,"cx-product-image-zoom-thumbnails",4),_("productImage",function(m){return o.changeImage(m)}),p()),t&2&&(c("ngIf",h(1,3,o.mainImage$)),d(2),c("thumbs$",o.thumbnails$)("activeThumb",o.activeThumb))},dependencies:[$,N,j,Ue,L],encapsulation:2,changeDetection:0});let n=i;return n})(),Ke=(()=>{let i=class i{handleClick(e){e.target.tagName===this.el.nativeElement.tagName&&this.close("Cross click")}constructor(e,t){this.launchDialogService=e,this.el=t,this.iconType=F,this.focusConfig={trap:!0,block:!0,autofocus:"button",focusOnEscape:!0}}close(e=""){this.launchDialogService.closeDialog(e)}};i.\u0275fac=function(t){return new(t||i)(x(ne),x(M))},i.\u0275cmp=P({type:i,selectors:[["cx-product-image-zoom-dialog"]],hostBindings:function(t,o){t&1&&_("click",function(m){return o.handleClick(m)})},inputs:{galleryIndex:"galleryIndex"},decls:9,vars:6,consts:[[1,"cx-image-zoom-dialog",3,"cxFocus"],[1,"cx-dialog-content"],[1,"cx-dialog-header"],["type","button",1,"close",3,"click"],["aria-hidden","true"],[3,"type"],[1,"cx-dialog-body"],[3,"galleryIndex"]],template:function(t,o){t&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),g(4,"cxTranslate"),_("click",function(){return o.close("cross click")}),l(5,"span",4),v(6,"cx-icon",5),p()()(),l(7,"div",6),v(8,"cx-product-image-zoom-view",7),p()()()),t&2&&(c("cxFocus",o.focusConfig),d(3),U("aria-label",h(4,4,"productImageZoomDialog.close")),d(3),c("type",o.iconType.CLOSE),d(2),c("galleryIndex",o.galleryIndex))},dependencies:[N,xe,qe,Y],encapsulation:2,changeDetection:0});let n=i;return n})(),Je={launch:{PRODUCT_IMAGE_ZOOM:{inline:!0,component:Ke,dialogType:Ce.DIALOG}}},et=(()=>{let i=class i{set expandImage(e){e&&this.triggerZoom()}constructor(e,t){this.launchDialogService=e,this.vcr=t,this.iconType=F,this.subscriptions=new A,this.dialogClose=new B}triggerZoom(){let e=this.launchDialogService.launch("PRODUCT_IMAGE_ZOOM",this.vcr);e&&this.subscriptions.add(Q([e,this.launchDialogService.dialogClose]).pipe(T(([t])=>{this.galleryIndex&&(t.instance.galleryIndex=this.galleryIndex)}),C(([,t])=>!!t),T(([t])=>{this.launchDialogService.clear("PRODUCT_IMAGE_ZOOM"),t?.destroy(),this.dialogClose.emit(),this.expandButton.nativeElement.focus()})).subscribe())}ngOnDestroy(){this.subscriptions.unsubscribe()}};i.\u0275fac=function(t){return new(t||i)(x(ne),x(me))},i.\u0275cmp=P({type:i,selectors:[["cx-product-image-zoom-trigger"]],viewQuery:function(t,o){if(t&1&&S(Ne,5),t&2){let r;V(r=Z())&&(o.expandButton=r.first)}},inputs:{galleryIndex:"galleryIndex",expandImage:"expandImage"},outputs:{dialogClose:"dialogClose"},decls:6,vars:4,consts:[["expandButton",""],[1,"btn","btn-link","cx-action-link",3,"click"],[3,"type"]],template:function(t,o){if(t&1){let r=y();l(0,"button",1,0),_("click",function(){return f(r),I(o.triggerZoom())}),l(2,"span"),le(3),g(4,"cxTranslate"),v(5,"cx-icon",2),p()()}t&2&&(d(3),ue(" ",h(4,2,"productImageZoomTrigger.expand")," "),d(2),c("type",o.iconType.EXPAND_ARROWS))},dependencies:[N,Y],encapsulation:2,changeDetection:0});let n=i;return n})(),tt=(()=>{let i=class i extends Me{constructor(e){super(e),this.currentProductService=e,this.expandImage=new w(!1),this.product$=this.product$}openImage(e){this.mainMediaContainer.next(e),this.selectedIndex=this.mainMediaContainer.value?.zoom?.galleryIndex}triggerZoom(e){this.expandImage.next(e)}};i.\u0275fac=function(t){return new(t||i)(x(oe))},i.\u0275cmp=P({type:i,selectors:[["cx-product-images"]],features:[de],decls:6,vars:6,consts:[["thumb",""],[4,"ngIf"],[3,"click","container"],[3,"dialogClose","expandImage","galleryIndex"],["role","region","tabindex","-1","class","thumbs","itemWidth","120px",3,"items","hideIndicators","template",4,"ngIf"],["role","region","tabindex","-1","itemWidth","120px",1,"thumbs",3,"items","hideIndicators","template"],["tabindex","0","format","product",3,"focus","container"]],template:function(t,o){t&1&&(u(0,Ge,3,3,"ng-container",1),g(1,"async"),u(2,Xe,3,3,"ng-container",1),g(3,"async"),u(4,We,2,5,"ng-template",null,0,J)),t&2&&(c("ngIf",h(1,2,o.mainImage$)),d(2),c("ngIf",h(3,4,o.thumbs$)))},dependencies:[ae,$,j,et,L,Y],encapsulation:2,changeDetection:0});let n=i;return n})(),it=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=k({type:i}),i.\u0275inj=R({providers:[ee(Je),ee({cmsComponents:{ProductImagesComponent:{component:tt}}})],imports:[Pe,_e,Ie,be,ve,Te,ye,fe]});let n=i;return n})(),De=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=k({type:i}),i.\u0275inj=R({imports:[it]});let n=i;return n})();var yt=(()=>{let i=class i{};i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=k({type:i}),i.\u0275inj=R({imports:[De]});let n=i;return n})();export{yt as ProductImageZoomModule};
