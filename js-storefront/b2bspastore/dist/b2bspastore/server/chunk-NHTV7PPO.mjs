import './polyfills.server.mjs';
import{e as ce,i as ae,j as ue,k as de}from"./chunk-XYKJRGMK.mjs";import{c as ne}from"./chunk-ADLYYZ7J.mjs";import{Ba as se,Ca as re,Da as I,Nb as _,O as c,Ob as ie,_a as oe,c as L,d as m,da as te,e as d,f as K,g as X,h as b,i as Y,j as O,k as ee}from"./chunk-ICSRVU46.mjs";import{Cd as U,Ea as S,Fa as E,Ha as y,Ja as n,Ka as W,L as Z,Ra as A,S as v,T as q,Ta as J,X as V,a as Q,q as R,wa as M,x as h,y as B}from"./chunk-JSDTXUAI.mjs";import{a as l,b as z}from"./chunk-GHFNAT2I.mjs";var F=class{},C=(()=>{let e=class e{constructor(s){this.asmAdapter=s}customerSearch(s){return this.asmAdapter.customerSearch(s)}customerLists(){return this.asmAdapter.customerLists()}bindCart(s){return this.asmAdapter.bindCart(s)}createCustomer(s){return this.asmAdapter.createCustomer(s)}};e.\u0275fac=function(r){return new(r||e)(n(F))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),ht=new y("CustomerSearchPageNormalizer"),lt=new y("CustomerListsNormalizer"),Se=(()=>{let e=class e{constructor(s,r,i){this.commandService=s,this.asmConnector=r,this.userAccountFacade=i,this.bindCartCommand$=this.commandService.create(a=>this.userAccountFacade.get().pipe(h(g=>{if(g?.uid)return g.uid;throw new Error("No identifier for authenticated user found.")}),V(1),q(g=>this.asmConnector.bindCart({cartId:a,customerId:g}))))}bindCart(s){return this.bindCartCommand$.execute(s)}};e.\u0275fac=function(r){return new(r||e)(n(_),n(C),n(ne))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),me=(()=>{let e=class e{constructor(s,r){this.asmConnector=s,this.command=r,this.createCustomerCommand=this.command.create(({user:i})=>this.asmConnector.createCustomer(i))}createCustomer(s){return this.createCustomerCommand.execute({user:s})}};e.\u0275fac=function(r){return new(r||e)(n(C),n(_))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),le="[Asm] UI Update",T=class{constructor(e){this.payload=e,this.type=le}},Ce="asm",f="[asm] Customer search data",p="[asm] Customer list customers search data",fe="[Asm] Customer Search",Le="[Asm] Customer Search Fail",Te="[Asm] Customer Search Success",ve="[Asm] Customer Search Reset",pe="[Asm] Customer List Customers Search",Me="[Asm] Customer List Customers Search Fail",Ue="[Asm] Customer List Customers Search Success",be="[Asm] Customer List Customers Search Reset",j=class extends c.LoaderLoadAction{constructor(e){super(f),this.payload=e,this.type=fe}},D=class extends c.LoaderFailAction{constructor(e){super(f),this.payload=e,this.type=Le}},w=class extends c.LoaderSuccessAction{constructor(e){super(f),this.payload=e,this.type=Te}},k=class extends c.LoaderResetAction{constructor(){super(f),this.type=ve}},N=class extends c.LoaderLoadAction{constructor(e){super(p),this.payload=e,this.type=pe}},H=class extends c.LoaderFailAction{constructor(e){super(p),this.payload=e,this.type=Me}},$=class extends c.LoaderSuccessAction{constructor(e){super(p),this.payload=e,this.type=Ue}},x=class extends c.LoaderResetAction{constructor(){super(p),this.type=be}},Oe="[Auth] Logout Customer Support Agent";var Ie=(()=>{let e=class e{constructor(s,r){this.actions$=s,this.asmConnector=r,this.logger=W(te),this.customerSearch$=b(()=>this.actions$.pipe(O(fe),h(i=>i.payload),M(i=>this.asmConnector.customerSearch(i).pipe(h(a=>new w(a)),v(a=>R(new D(I(a,this.logger)))))))),this.customerListCustomersSearch$=b(()=>this.actions$.pipe(O(pe),h(i=>i.payload),M(i=>this.asmConnector.customerSearch(i).pipe(h(a=>new $(a)),v(a=>R(new H(I(a,this.logger))))))))}};e.\u0275fac=function(r){return new(r||e)(n(Y),n(C))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),_e=[Ie],Fe={collapsed:!1};function je(t=Fe,e){switch(e.type){case le:return l(l({},t),e.payload);default:return t}}function De(){return{customerSearchResult:c.loaderReducer(f),customerListCustomersSearchResult:c.loaderReducer(p),asmUi:je}}var ge=new y("AsmReducers"),we={provide:ge,useFactory:De};function ke(t){return function(e,o){return o.type===Oe&&(e=z(l({},e),{customerSearchResult:{}})),t(e,o)}}var Ne=[ke],P=K(Ce),Re=d(P,t=>t.asmUi),Ee=d(P,t=>t.customerSearchResult),He=d(Ee,t=>c.loaderValueSelector(t)),$e=d(Ee,t=>c.loaderLoadingSelector(t)),G=d(P,t=>t.customerListCustomersSearchResult),xe=d(G,t=>c.loaderValueSelector(t)),Pe=d(G,t=>c.loaderLoadingSelector(t)),Ge=d(G,t=>c.loaderErrorSelector(t));var he=(()=>{let e=class e{constructor(s,r,i){this.queryService=s,this.asmConnector=r,this.store=i,this.customerListQuery$=this.queryService.create(()=>this.asmConnector.customerLists(),{reloadOn:void 0,resetOn:void 0})}getCustomerLists(){return this.customerListQuery$.get()}getCustomerListsState(){return this.customerListQuery$.getState()}customerListCustomersSearch(s){this.store.dispatch(new N(s))}getCustomerListCustomersSearchResults(){return this.store.pipe(m(xe))}getCustomerListCustomersSearchResultsLoading(){return this.store.pipe(m(Pe))}customerListCustomersSearchReset(){this.store.dispatch(new x)}getCustomerListCustomersSearchResultsError(){return this.store.pipe(m(Ge))}};e.\u0275fac=function(r){return new(r||e)(n(ie),n(C),n(L))},e.\u0275prov=S({token:e,factory:e.\u0275fac});let t=e;return t})(),ze=[he,{provide:de,useExisting:he},Se,{provide:ae,useExisting:Se},me,{provide:ue,useExisting:me}],Qe=(()=>{let e=class e{constructor(s,r,i){this.statePersistenceService=s,this.store=r,this.authStorageService=i,this.subscription=new Q,this.key="asm"}initSync(){this.subscription.add(this.statePersistenceService.syncWithStorage({key:this.key,state$:this.getAsmState(),onRead:s=>this.onRead(s)}))}getAsmState(){return B([this.store.pipe(Z(s=>!!s.asm),m(Re)),R(this.authStorageService.getEmulatedUserToken()),this.authStorageService.getTokenTarget()]).pipe(h(([s,r,i])=>{let a=r;return a&&(a=l({},r),delete a.refresh_token),{ui:s,emulatedUserToken:a,tokenTarget:i}}))}onRead(s){s&&(s.ui&&this.store.dispatch(new T(s.ui)),s.emulatedUserToken&&this.authStorageService.setEmulatedUserToken(s.emulatedUserToken),s.tokenTarget&&this.authStorageService.setTokenTarget(s.tokenTarget))}ngOnDestroy(){this.subscription.unsubscribe()}};e.\u0275fac=function(r){return new(r||e)(n(se),n(L),n(ce))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),Be=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=A({type:e}),e.\u0275inj=E({providers:[we],imports:[U,re,X.forFeature(Ce,ge,{metaReducers:Ne}),ee.forFeature(_e)]});let t=e;return t})();function Ze(t){return()=>t.initSync()}var Ct=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=A({type:e}),e.\u0275inj=E({providers:[C,{provide:oe,useFactory:Ze,deps:[Qe],multi:!0},...ze],imports:[U,Be]});let t=e;return t})(),ft=(()=>{let e=class e{constructor(s){this.store=s}customerSearch(s){this.store.dispatch(new j(s))}customerSearchReset(){this.store.dispatch(new k)}getCustomerSearchResults(){return this.store.pipe(m(He))}getCustomerSearchResultsLoading(){return this.store.pipe(m($e))}updateAsmUiState(s){this.store.dispatch(new T(s))}getAsmUiState(){return this.store.pipe(m(Re))}};e.\u0275fac=function(r){return new(r||e)(n(L))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let t=e;return t})(),pt=(()=>{let e=class e{transform(s,...r){return s(...r)}};e.\u0275fac=function(r){return new(r||e)},e.\u0275pipe=J({name:"cxArgs",type:e,pure:!0});let t=e;return t})(),gt=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=A({type:e}),e.\u0275inj=E({});let t=e;return t})(),u=function(t){return t[t.ASC=1]="ASC",t[t.DESC=-1]="DESC",t}(u||{});function qe(t=u.ASC){return(e,o)=>e===o?0:(e===!0?-1:1)*t}var Rt=qe(u.ASC);function Ve(t=u.ASC){return(e,o)=>e===o?0:(e<o?-1:1)*t}var Et=Ve(u.ASC);function ye(t=u.ASC){return(e,o)=>{let s=e==null,r=o==null;return s===r?0:(s?-1:1)*t}}var yt=ye(u.ASC),At=ye(u.DESC);function Ae(t=u.ASC){return(e,o)=>e===o?0:(e-o<0?-1:1)*t}var Lt=Ae(u.ASC),Tt=Ae(u.DESC);function We(t=u.ASC,e,o){return(s,r)=>(s??"").localeCompare(r??"",e,o)*t}var vt=We(u.ASC);function Mt(...t){return(e,o)=>{for(let s of t){let r=s(e,o);if(r!==0)return r}return 0}}function Ut(t,e,o){if(typeof e=="function")return(s,r)=>e(s[t],r[t]);if(o)return(s,r)=>o(s[t][e],r[t][e]);throw new Error("No comparator provided")}var bt=t=>typeof t=="string",Ot=t=>typeof t=="number",It=t=>typeof t=="boolean";function _t(t,e){return(o,s)=>t(o)&&t(s)?e(o,s):0}export{F as a,ht as b,lt as c,Ct as d,ft as e,pt as f,gt as g,u as h,qe as i,Ve as j,ye as k,We as l,Mt as m,Ut as n,bt as o,Ot as p,It as q,_t as r};
