import{H as J,c as H}from"./chunk-TQW2KZ64.js";import{M as X,O as Y,P as z}from"./chunk-VAXL2NXV.js";import{$a as j,$e as O,Bb as g,Ef as W,Ff as G,Ib as M,Jb as u,Ob as a,Pa as p,Pb as s,Qa as B,Qb as d,S as T,Yd as k,ab as C,be as q,dd as L,ea as v,fa as f,fd as U,gb as m,ha as I,hb as h,ib as D,ie as w,je as b,jf as Q,kf as V,na as F,nc as E,nd as $,oa as x,qa as c,r as l,re as N,tc as R,v as o,va as P,w as y,wa as A,zb as S}from"./chunk-ST632LWR.js";var ee=()=>({cxRoute:"cart"}),K=r=>({count:r}),te=r=>({total:r}),ie=(()=>{let e=class e{constructor(t,i,n,Z,_){this.activeCartFacade=t,this.authService=i,this.statePersistenceService=n,this.siteContextParamsService=Z,this.eventService=_}getQuantity(){return this.activeCartRequired().pipe(f(t=>t?this.activeCartFacade.getActive().pipe(v({totalUnitCount:0}),o(i=>i.totalUnitCount||0)):l(0)))}getTotalPrice(){return this.activeCartRequired().pipe(f(t=>t?this.activeCartFacade.getActive().pipe(o(i=>i.totalPrice?.formattedValue??"")):l("")))}activeCartRequired(){return y([this.hasActiveCartInStorage(),this.authService.isUserLoggedIn(),this.isCartCreated()]).pipe(o(([t,i,n])=>t||i||n),T(),I(t=>!t,!0))}hasActiveCartInStorage(){return this.getCartStateFromBrowserStorage().pipe(o(t=>!!t?.active))}isCartCreated(){return this.eventService.get(H).pipe(o(t=>!0),v(!1))}getCartStateFromBrowserStorage(){return this.siteContextParamsService.getValues([k]).pipe(o(t=>this.statePersistenceService.readStateFromStorage({key:"cart",context:t,storageType:w.LOCAL_STORAGE})))}};e.\u0275fac=function(i){return new(i||e)(c(J),c(q),c(b),c(O),c(N))},e.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),re=(()=>{let e=class e{constructor(t){this.miniCartComponentService=t,this.iconTypes=X,this.quantity$=this.miniCartComponentService.getQuantity(),this.total$=this.miniCartComponentService.getTotalPrice()}};e.\u0275fac=function(i){return new(i||e)(B(ie))},e.\u0275cmp=P({type:e,selectors:[["cx-mini-cart"]],decls:13,vars:29,consts:[[3,"routerLink"],[3,"type"],[1,"total"],[1,"count"]],template:function(i,n){i&1&&(m(0,"a",0),a(1,"cxUrl"),a(2,"async"),a(3,"cxTranslate"),D(4,"cx-icon",1),m(5,"span",2),S(6),a(7,"async"),a(8,"cxTranslate"),h(),m(9,"span",3),S(10),a(11,"async"),a(12,"cxTranslate"),h()()),i&2&&(C("routerLink",s(1,5,M(22,ee))),j("aria-label",d(3,9,"miniCart.item",u(23,K,s(2,7,n.quantity$)))),p(4),C("type",n.iconTypes.CART),p(2),g(" ",d(8,14,"miniCart.total",u(25,te,s(7,12,n.total$)))," "),p(4),g(" ",d(12,19,"miniCart.count",u(27,K,s(11,17,n.quantity$)))," "))},dependencies:[L,Y,E,Q,W],encapsulation:2,changeDetection:0});let r=e;return r})(),he=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=A({type:e}),e.\u0275inj=x({providers:[$({cmsComponents:{MiniCartComponent:{component:re}}})],imports:[R,U,V,z,G]});let r=e;return r})();export{re as MiniCartComponent,ie as MiniCartComponentService,he as MiniCartModule};
